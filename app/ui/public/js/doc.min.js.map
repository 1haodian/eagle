{"version":3,"sources":["doc.js"],"names":["__sortTable_generateFilteredList","hasContentByPathList","object","content","pathList","i","length","path","value","common","getValueByPath","toUpperCase","indexOf","hasContent","depth","keys","undefined","isArray","Object","$","Array","list","search","order","orderAsc","searchPathList","_list","_search","push","array","doSort","merge","obj1","obj2","each","key","oriValue","isEmpty","scope","window","self","template","str","_regex","RegExp","replace","unit","defaultValue","split","setValueByPath","_nextPath","_key","slice","_start","_end","_inArray","_unit","parseJSON","defaultVal","Number","toString","trim","JSON","parse","err","arguments","console","warn","stringify","json","test","val","extend","target","origin","mergedObj","obj","getKeys","map","string","safeText","capitalize","match","preFill","len","findIndex","findAll","caseSensitive","_val","find","index","minus","list1","list2","path1","path2","item","val1","remove","grep","asc","sortList","sortFunc","val2","index1","index2","sort","deferred","all","deferredList","doCheck","rest","hasFailure","reject","failureList","resolve","successList","Deferred","then","promise","data","always","finally","number","isNumber","num","isNaN","toFixed","fixed","format","abbr","isByte","digits","decPlaces","Math","pow","abbrev","base","sign","abs","size","round","compare","num1","num2","inRange","rangList","start","end","sum","total","Module","dependencies","this","queueList","routeList","portalList","widgetList","requireRest","requireDeferred","is_chrome","navigator","userAgent","is_safari","is_opera","toLowerCase","addClass","_host","_app","localStorage","getItem","host","setItem","appName","viewPath","clear","removeItem","_moduleStateId","_registerAppList","_lastRegisterApp","_hookRequireFunc","_TRS","buildTimestamp","random","prototype","service","type","args","directive","controller","portal","isSite","route","state","config","url","widget","name","renderFunc","require","scriptURL","_this","setTimeout","getScript","baseURL","error","requireCheck","requireCSS","styleURL","rel","href","appendTo","getInstance","moduleName","module","angular","when","apply","site","parser","document","createElement","templateUrl","application","register","info","get","res","promiseList","oriApp","moduleList","trigger","appList","app","on","event","routeResolve","auth","Site","getPromise","Application","_router","$wrapState","$q","state_next","siteId","param_next","appType","descriptor","modules","log","go","Time","state_current","param_current","STATE_NAME_MATCH","eagleApp","concat","$stateProvider","$urlRouterProvider","$httpProvider","$animateProvider","otherwise","abstract","resolveConfig","$scope","$urlRouter","PageConfig","Portal","Widget","Entity","UI","Policy","_WrapState","_PageConfig","_Portal","_Widget","_Entity","_Site","_Application","_UI","_Time","_Policy","defineProperty","ele","last","element","$on","next","nextParam","current","currentParam","currentName","nextName","reset","_innerSearch","param","location","notify","getNavClass","customizeTimeRange","modal","setLastDuration","hours","endTime","startTime","clone","subtract","timeRange","updateTimeRange","verifyTime","alert","ready","bootstrap","removeClass","UNITS","keepTime","serviceModule","reloadListenerList","$Time","time","_mom","moment","utcOffset","UTC_OFFSET","date","minutes","seconds","millisecond","add","weekday","TIME_RANGE_PICKER","pickerType","_reloadListenerList","FORMAT","SHORT_FORMAT","startTimeValue","endTimeValue","listener","onReload","func","offReload","_func","diff","from","to","diffStr","rows","duration","interval","floor","join","diffInterval","timeDiff","align","ceil","timestamp","valueOf","millionFormat","s","m","h","defer","title","subTitle","navPath","hideTitle","checkSite","checkApplication","convertSitePortal","defaultPortalList","icon","showFunc","adminPortalList","mainPortalList","sitePortalList","connectedMainPortalList","sitePortals","backHome","refresh","siteList","siteName","siteHome","hasApp","applicationList","mainWidgetList","siteWidgetList","displayWidgetList","siteWidgets","$state","$location","$stateParams","_targetState","_targetPriority","option","priority","equals","params","reload","defineProperties","bind","$http","wrapList","_done","_promise","splice","withThen","_then","query","_refresh","create","post","entity","method","headers","Content-Type","delete","uuid","oriList","tgtList","queryMetadata","process","metaList","deleteMetadata","linkApplications","ApplicationList","applications","providers","configurable","switchSite","id","providerList","findProvider","provider","wrapPromise","retFunc","notifyFunc","resolveFunc","rejectFunc","holder","closeFunc","unlock","$rootScope","$compile","_bindShortcut","$dialog","which","is","click","_fieldDialog","fieldList","checkFunc","_deferred","$mdl","_entity","$new","lock","field","TMPL_FIELDS","filter","focus","getFieldDescription","description","emptyFieldList","optional","newField","fieldConfirm","dialog","_customize","removeField","confirm","createConfirm","deleteConfirm","TMPL_DELETE","publisherTypes","org.apache.eagle.alert.engine.publisher.impl.AlertEmailPublisher","displayFields","fields","org.apache.eagle.alert.engine.publisher.impl.AlertKafkaPublisher","org.apache.eagle.alert.engine.publisher.impl.AlertSlackPublisher","org.apache.eagle.alert.engine.publisher.impl.AlertEagleStorePlugin","policy","encodeURIComponent","stop","eagleComponents","restrict","$element","$attrs","setState","bool","isSorting","$parent","workMessage","worker_id","cacheFilteredList","$apply","sortmatch","worker","Worker","pageNumber","pageSize","maxSize","orderKey","sortpath","checkSortClass","cacheSearch","cacheOrder","cacheOrderAsc","getFilteredList","fullList","sortTable","postMessage","$watch","___SORT_TABLE___","Date","addEventListener","removeEventListener","compile","contents","defaultPageSizeList","append","$toolContainer","insertBefore","$search","$pageSize","$this","_sortpath","attr","prepend","$tr","$navigation","link","attrs","ngModel","$parsers","parseInt","$formatters","color","charts","Chart","chartResize","chart","resize","series","category","categoryFunc","xTitle","yTitle","refreshChart","maxYAxis","legendList","categoryList","seriesList","point","x","yAxisIndex","max","y","yAxis","text","tooltip","legend","grid","top","left","right","bottom","containLabel","xAxis","axisTick","show","setOption","lastTooltipEvent","echarts","init","chartClick","e","getZr","componentType","dispose","$templateCache","templatePath","staticInclude","cache","success","response","html","$ctrl","updateScope","clearTimeout","updateId","$setViewValue","innerHeight","editLock","editor","ace","edit","session","getSession","container","style","lineHeight","setOptions","fontSize","setTheme","$blockScrolling","Infinity","getValue","setUseWorker","setUseWrapMode","setMode","newValue","setValue","destroy","naBlock","transclude","eagleControllers","colorList","createSite","message","$interval","displayType","alertList","refreshInterval","cancel","alertId","streamList","stream","dataSource","dataSources","showDataSource","updateList","policyList","deletePolicy","startPolicy","stopPolicy","updatePolicy","policyName","encodePolicyName","definition","executionPlan","policyPublisherList","schedule","assignment","assignments","monitoredStreams","queues","queue","queueId","tab","setTab","connectPolicyEditController","newArgs","policyEditController","$timeout","autoDescription","autoPolicyDescription","outputStreams","inputStreams","alertDefinition","subject","body","severity","partitionSpec","parallelismHint","cacheSearchType","cacheSearchSourceKey","searchApplications","searchType","searchSourceKey","newPolicy","sourceTab","setSourceTab","getSearchApplication","streams","groupName","streamId","group","isInputStreamSelected","inArray","checkPromise","definitionMessage","checkDefinition","policyExecutionPlan","streamPartitions","isOutputStreamSelected","checkOutputStream","partition","addPartition","columns","newPartitionCheckColumn","column","newPartitionClickColumn","addPartitionConfirm","removePartition","publisherList","addPublisherType","publisher","_exist","addPublisher","existPublisher","dedupIntervalMin","serializer","properties","removePublisher","checkPublisherName","addPublisherConfirm","saveLock","saveCheck","saveConfirm","validate","publisherPromiseList","policyLock","getState","deleteSite","newSite","$sce","mapApplications","uninstalledApplicationList","installed","refreshApplications","getAppStatusClass","status","getStartedAppCount","showAppDetail","tmpApp","docs","install","uninstall","installHTML","trustAsHtml","uninstallHTML","generalFields","advancedFields","customizeFields","installLock","required","configuration","checkJarPath","jarPath","mode","collapseCheck","isCollapsed","dataId","hasClass","checkFields","pass","getCustomFields","configByJSON","installAppConfirm","installApp","removeAttr","missDep","dep","uninstallApp","startApp","ret","stopApp","editApp"],"mappings":"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","file":"doc.min.js","sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar __sortTable_generateFilteredList;\n\n(function () {\n\t'use strict';\n\n\tvar isArray;\n\tif(typeof $ !== \"undefined\") {\n\t\tisArray = $.isArray;\n\t} else {\n\t\tisArray = Array.isArray;\n\t}\n\n\tfunction hasContentByPathList(object, content, pathList) {\n\t\tfor(var i = 0 ; i < pathList.length ; i += 1) {\n\t\t\tvar path = pathList[i];\n\t\t\tvar value = common.getValueByPath(object, path);\n\t\t\tif((value + \"\").toUpperCase().indexOf(content) >= 0) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction hasContent(object, content, depth) {\n\t\tvar i, keys;\n\n\t\tdepth = depth || 1;\n\t\tif(!content) return true;\n\t\tif(depth > 10) return false;\n\n\t\tif(object === undefined || object === null) {\n\t\t\treturn false;\n\t\t} else if(isArray(object)) {\n\t\t\tfor(i = 0 ; i < object.length ; i += 1) {\n\t\t\t\tif(hasContent(object[i], content, depth + 1)) return true;\n\t\t\t}\n\t\t} else if(typeof object === \"object\") {\n\t\t\tkeys = Object.keys(object);\n\t\t\tfor(i = 0 ; i < keys.length ; i += 1) {\n\t\t\t\tvar value = object[keys[i]];\n\t\t\t\tif(hasContent(value, content, depth + 1)) return true;\n\t\t\t}\n\t\t} else {\n\t\t\treturn (object + \"\").toUpperCase().indexOf(content) >= 0;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t__sortTable_generateFilteredList = function(list, search, order, orderAsc, searchPathList) {\n\t\tvar i, _list;\n\t\tvar _search = (search + \"\").toUpperCase();\n\n\t\tif (search) {\n\t\t\t_list = [];\n\t\t\tif(searchPathList) {\n\t\t\t\tfor(i = 0 ; i < list.length ; i += 1) {\n\t\t\t\t\tif(hasContentByPathList(list[i], _search, searchPathList)) _list.push(list[i]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor(i = 0 ; i < list.length ; i += 1) {\n\t\t\t\t\tif(hasContent(list[i], _search)) _list.push(list[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t_list = list;\n\t\t}\n\n\t\tif (order) {\n\t\t\tcommon.array.doSort(_list, order, orderAsc);\n\t\t}\n\n\t\treturn _list;\n\t};\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function () {\n\t'use strict';\n\n\tvar scope = {};\n\tif(typeof window != 'undefined') {\n\t\tscope = window;\n\t} else if(typeof self != 'undefined') {\n\t\tscope = self;\n\t}\n\tvar common = scope.common = {};\n\n\t// ============================ Common ============================\n\tcommon.template = function (str, list) {\n\t\t$.each(list, function(key, value) {\n\t\t\tvar _regex = new RegExp(\"\\\\$\\\\{\" + key + \"\\\\}\", \"g\");\n\t\t\tstr = str.replace(_regex, value);\n\t\t});\n\t\treturn str;\n\t};\n\n\tcommon.getValueByPath = function (unit, path, defaultValue) {\n\t\tif(unit === null || unit === undefined) throw \"Unit can't be empty!\";\n\t\tif(path === \"\" || path === null || path === undefined) return unit;\n\n\t\tif(typeof path === \"string\") {\n\t\t\tpath = path.replace(/\\[(\\d+)\\]/g, \".$1\").replace(/^\\./, \"\").split(/\\./);\n\t\t}\n\t\tfor(var i = 0 ; i < path.length ; i += 1) {\n\t\t\tunit = unit[path[i]];\n\t\t\tif(unit === null || unit === undefined) {\n\t\t\t\tunit = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(unit === null && defaultValue !== undefined) {\n\t\t\tunit = defaultValue;\n\t\t}\n\t\treturn unit;\n\t};\n\n\tcommon.setValueByPath = function(unit, path, value) {\n\t\tif(!unit || typeof path !== \"string\" || path === \"\") throw \"Unit or path can't be empty!\";\n\n\t\tvar _inArray = false;\n\t\tvar _end = 0;\n\t\tvar _start = 0;\n\t\tvar _unit = unit;\n\n\t\tfunction _nextPath(array) {\n\t\t\tvar _key = path.slice(_start, _end);\n\t\t\tif(_inArray) {\n\t\t\t\t_key = _key.slice(0, -1);\n\t\t\t}\n\t\t\tif(!_unit[_key]) {\n\t\t\t\tif(array) {\n\t\t\t\t\t_unit[_key] = [];\n\t\t\t\t} else {\n\t\t\t\t\t_unit[_key] = {};\n\t\t\t\t}\n\t\t\t}\n\t\t\t_unit = _unit[_key];\n\t\t}\n\n\t\tfor(; _end < path.length ; _end += 1) {\n\t\t\tif(path[_end] === \".\") {\n\t\t\t\t_nextPath(false);\n\t\t\t\t_start = _end + 1;\n\t\t\t\t_inArray = false;\n\t\t\t} else if(path[_end] === \"[\") {\n\t\t\t\t_nextPath(true);\n\t\t\t\t_start = _end + 1;\n\t\t\t\t_inArray = true;\n\t\t\t}\n\t\t}\n\n\t\t_unit[path.slice(_start, _inArray ? -1 : _end)] = value;\n\n\t\treturn unit;\n\t};\n\n\tcommon.parseJSON = function (str, defaultVal) {\n\t\tif(str && Number(str).toString() !== str) {\n\t\t\ttry {\n\t\t\t\tstr = (str + \"\").trim();\n\t\t\t\treturn JSON.parse(str);\n\t\t\t} catch(err) {}\n\t\t}\n\n\t\tif(arguments.length === 1) {\n\t\t\tconsole.warn(\"Can't parse JSON: \" + str);\n\t\t}\n\n\t\treturn defaultVal === undefined ? null : defaultVal;\n\t};\n\n\tcommon.stringify = function(json) {\n\t\treturn JSON.stringify(json, function(key, value) {\n\t\t\tif(/^(_|\\$)/.test(key)) return undefined;\n\t\t\treturn value;\n\t\t});\n\t};\n\n\tcommon.isEmpty = function(val) {\n\t\tif($.isArray(val)) {\n\t\t\treturn val.length === 0;\n\t\t} else {\n\t\t\treturn val === null || val === undefined;\n\t\t}\n\t};\n\n\tcommon.extend = function(target, origin) {\n\t\t$.each(origin, function(key, value) {\n\t\t\tif(/^(_|\\$)/.test(key)) return;\n\n\t\t\ttarget[key] = value;\n\t\t});\n\t\treturn target;\n\t};\n\n\tfunction merge(obj1, obj2) {\n\t\t$.each(obj2, function (key, value) {\n\t\t\tvar oriValue = obj1[key];\n\n\t\t\tif(typeof oriValue === \"object\" && typeof value === \"object\" && !common.isEmpty(value)) {\n\t\t\t\tmerge(oriValue, value);\n\t\t\t} else {\n\t\t\t\tobj1[key] = value;\n\t\t\t}\n\t\t});\n\t}\n\n\tcommon.merge = function (mergedObj) {\n\t\tfor(var i = 1 ; i < arguments.length ; i += 1) {\n\t\t\tvar obj = arguments[i];\n\t\t\tmerge(mergedObj, obj);\n\t\t}\n\n\t\treturn mergedObj;\n\t};\n\n\tcommon.getKeys = function (obj) {\n\t\treturn $.map(obj, function (val, key) {\n\t\t\treturn key;\n\t\t});\n\t};\n\n\t// ============================ String ============================\n\tcommon.string = {};\n\tcommon.string.safeText = function (str) {\n\t\treturn str\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;');\n\t};\n\n\tcommon.string.capitalize = function (str) {\n\t\treturn (str + \"\").replace(/\\b\\w/g, function(match) {\n\t\t\treturn match.toUpperCase();\n\t\t});\n\t};\n\n\tcommon.string.preFill = function (str, key, len) {\n\t\tstr = str + \"\";\n\t\tlen = len || 2;\n\t\twhile(str.length < len) {\n\t\t\tstr = key + str;\n\t\t}\n\t\treturn str;\n\t};\n\n\t// ============================ Array =============================\n\tcommon.array = {};\n\n\tcommon.array.findIndex = function(val, list, path, findAll, caseSensitive) {\n\t\tvar _list = [];\n\t\tval = caseSensitive === false ? (val + \"\").toUpperCase() : val;\n\n\t\tfor(var i = 0 ; i < list.length ; i += 1) {\n\t\t\tvar unit = list[i];\n\t\t\tvar _val = common.getValueByPath(unit, path);\n\t\t\t_val = caseSensitive === false ? (_val + \"\").toUpperCase() : _val;\n\n\t\t\tif(_val === val) {\n\t\t\t\tif(!findAll) return i;\n\t\t\t\t_list.push(i);\n\t\t\t}\n\t\t}\n\n\t\treturn findAll ? _list: -1;\n\t};\n\n\tcommon.array.find = function(val, list, path, findAll, caseSensitive) {\n\t\tvar index = common.array.findIndex(val, list, path, findAll, caseSensitive);\n\n\t\tif(findAll) {\n\t\t\treturn $.map(index, function (index) {\n\t\t\t\treturn list[index];\n\t\t\t});\n\t\t} else {\n\t\t\treturn index === -1 ? null : list[index];\n\t\t}\n\t};\n\n\tcommon.array.minus = function (list1, list2, path1, path2) {\n\t\tif(arguments.length === 3) path2 = path1;\n\t\tvar list = [];\n\t\t$.each(list1, function (i, item) {\n\t\t\tvar val1 = common.getValueByPath(item, path1);\n\t\t\tif(!common.array.find(val1, list2, path2)) {\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t});\n\t\treturn list;\n\t};\n\n\tcommon.array.remove = function (val, list, path) {\n\t\treturn $.grep(list, function (obj) {\n\t\t\treturn common.getValueByPath(obj, path) !== val;\n\t\t});\n\t};\n\n\tcommon.array.doSort = function (list, path, asc, sortList) {\n\t\tvar sortFunc;\n\t\tsortList = sortList || [];\n\n\t\tif(asc !== false) {\n\t\t\tsortFunc = function (obj1, obj2) {\n\t\t\t\tvar val1 = common.getValueByPath(obj1, path);\n\t\t\t\tvar val2 = common.getValueByPath(obj2, path);\n\n\t\t\t\tvar index1 = common.array.findIndex(val1, sortList);\n\t\t\t\tvar index2 = common.array.findIndex(val2, sortList);\n\n\t\t\t\tif(index1 !== -1 && index2 === -1) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if(index1 == -1 && index2 !== -1) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if(index1 !== -1 && index2 !== -1) {\n\t\t\t\t\treturn index1 - index2;\n\t\t\t\t}\n\n\t\t\t\tif (val1 === val2) {\n\t\t\t\t\treturn 0;\n\t\t\t\t} else if (val1 === null || val1 === undefined || val1 < val2) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t};\n\t\t} else {\n\t\t\tsortFunc = function (obj1, obj2) {\n\t\t\t\tvar val1 = common.getValueByPath(obj1, path);\n\t\t\t\tvar val2 = common.getValueByPath(obj2, path);\n\n\t\t\t\tvar index1 = common.array.findIndex(val1, sortList);\n\t\t\t\tvar index2 = common.array.findIndex(val2, sortList);\n\n\t\t\t\tif(index1 !== -1 && index2 === -1) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if(index1 == -1 && index2 !== -1) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if(index1 !== -1 && index2 !== -1) {\n\t\t\t\t\treturn index1 - index2;\n\t\t\t\t}\n\n\t\t\t\tif (val1 === val2) {\n\t\t\t\t\treturn 0;\n\t\t\t\t} else if (val1 === null || val1 === undefined || val1 < val2) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t};\n\t\t}\n\n\t\treturn list.sort(sortFunc);\n\t};\n\n\t// =========================== Deferred ===========================\n\tcommon.deferred = {};\n\n\tcommon.deferred.all = function (deferredList) {\n\t\tvar deferred = $.Deferred();\n\t\tvar successList = [];\n\t\tvar failureList = [];\n\t\tvar hasFailure = false;\n\t\tvar rest = deferredList.length;\n\t\tfunction doCheck() {\n\t\t\trest -= 1;\n\t\t\tif(rest === 0) {\n\t\t\t\tif(hasFailure) {\n\t\t\t\t\tdeferred.reject(failureList);\n\t\t\t\t} else {\n\t\t\t\t\tdeferred.resolve(successList);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t$.each(deferredList, function (i, deferred) {\n\t\t\tif(deferred && deferred.then) {\n\t\t\t\tvar promise = deferred.then(function (data) {\n\t\t\t\t\tsuccessList[i] = data;\n\t\t\t\t}, function (data) {\n\t\t\t\t\tfailureList[i] = data;\n\t\t\t\t\thasFailure = true;\n\t\t\t\t});\n\t\t\t\tif(promise.always) {\n\t\t\t\t\tpromise.always(doCheck);\n\t\t\t\t} else if(promise.finally) {\n\t\t\t\t\tpromise.finally(doCheck);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsuccessList[i] = deferred;\n\t\t\t\tdoCheck();\n\t\t\t}\n\t\t});\n\n\t\treturn deferred;\n\t};\n\n\t// ============================ Number ============================\n\tcommon.number = {};\n\n\tcommon.number.isNumber = function (num) {\n\t\treturn typeof num === \"number\" && !isNaN(num);\n\t};\n\n\tcommon.number.parse = function (num) {\n\t\tnum = Number(num);\n\t\tif(isNaN(num)) num = 0;\n\t\treturn num;\n\t};\n\n\tcommon.number.toFixed = function (num, fixed) {\n\t\tif(!common.number.isNumber(num)) return \"-\";\n\t\tnum = Number(num);\n\t\treturn num.toFixed(fixed || 0);\n\t};\n\n\tcommon.number.format = function (num, fixed) {\n\t\tif(!common.number.isNumber(num)) return \"-\";\n\t\treturn common.number.toFixed(num, fixed).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\t};\n\n\tcommon.number.abbr = function (number, isByte, digits) {\n\t\tdigits = digits || 2;\n\t\tvar decPlaces = Math.pow(10, digits);\n\t\tvar abbrev = isByte ? ['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'] : ['K', 'M', 'B', 'T', 'Q'];\n\t\tvar base = isByte ? 1024 : 1000;\n\t\tvar sign = number < 0 ? -1 : 1;\n\t\tvar unit = '';\n\t\tnumber = Math.abs(number);\n\t\tif(isNaN(number)) return \"-\";\n\n\t\tfor(var i = abbrev.length - 1; i >= 0; i--) {\n\t\t\tvar size = Math.pow(base, i + 1);\n\t\t\tif(size <= number) {\n\t\t\t\tnumber = Math.round(number * decPlaces / size) / decPlaces;\n\t\t\t\tif((number === base) && (i < abbrev.length - 1)) {\n\t\t\t\t\tnumber = 1;\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tunit = abbrev[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tunit = unit ? unit : \"\";\n\t\treturn (number * sign).toFixed(digits) + unit;\n\t};\n\n\tcommon.number.compare = function (num1, num2) {\n\t\tif(!common.number.isNumber(num1) || !common.number.isNumber(num2)) return \"-\";\n\t\tif(num1 === 0) return 'N/A';\n\t\treturn (num2 - num1) / num1;\n\t};\n\n\tcommon.number.inRange = function (rangList, num) {\n\t\tfor(var i = 0 ; i < rangList.length - 1 ; i += 1) {\n\t\t\tvar start = rangList[i];\n\t\t\tvar end = rangList[i + 1];\n\t\t\tif(start <= num && num < end) return i;\n\t\t}\n\t\treturn rangList.length - 1;\n\t};\n\n\tcommon.number.sum = function (list, path) {\n\t\tvar total = 0;\n\t\t$.each(list, function (i, obj) {\n\t\t\tvar value = common.getValueByPath(obj, path);\n\t\t\tif(typeof value === \"number\" && !isNaN(value)) {\n\t\t\t\ttotal += value;\n\t\t\t}\n\t\t});\n\t\treturn total;\n\t};\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function () {\n\t'use strict';\n\n\t// ======================================================================================\n\t// =                                   Browser Hooker                                   =\n\t// ======================================================================================\n\tvar is_chrome = navigator.userAgent.indexOf('Chrome') > -1;\n\tvar is_explorer = navigator.userAgent.indexOf('MSIE') > -1;\n\tvar is_firefox = navigator.userAgent.indexOf('Firefox') > -1;\n\tvar is_safari = navigator.userAgent.indexOf(\"Safari\") > -1;\n\tvar is_opera = navigator.userAgent.toLowerCase().indexOf(\"op\") > -1;\n\tif(is_chrome && is_safari) is_safari = false;\n\tif(is_chrome && is_opera) is_chrome = false;\n\n\tif(is_safari) {\n\t\t$(\"body\").addClass(\"safari\");\n\t}\n\n\t// ======================================================================================\n\t// =                                        Host                                        =\n\t// ======================================================================================\n\tvar _host = \"\";\n\tvar _app = {};\n\tif(localStorage) {\n\t\t_host = localStorage.getItem(\"host\") || \"\";\n\t\t_app = common.parseJSON(localStorage.getItem(\"app\"), {});\n\t}\n\n\twindow._host = function (host) {\n\t\tif(host) {\n\t\t\t_host = host.replace(/[\\\\\\/]+$/, \"\");\n\t\t\tif(localStorage) {\n\t\t\t\tlocalStorage.setItem(\"host\", _host);\n\t\t\t}\n\t\t}\n\t\treturn _host;\n\t};\n\n\twindow._app = function (appName, viewPath) {\n\t\tif(arguments.length) {\n\t\t\t_app[appName] = {\n\t\t\t\tviewPath: viewPath\n\t\t\t};\n\t\t\tif(localStorage) {\n\t\t\t\tlocalStorage.setItem(\"app\", JSON.stringify(_app));\n\t\t\t}\n\t\t}\n\t\treturn _app;\n\t};\n\n\twindow._app.clear = function () {\n\t\tif(localStorage) {\n\t\t\t_app = {};\n\t\t\tlocalStorage.removeItem(\"app\");\n\t\t}\n\t};\n\n\t// ======================================================================================\n\t// =                                      Register                                      =\n\t// ======================================================================================\n\tvar _moduleStateId = 0;\n\tvar _registerAppList = [];\n\tvar _lastRegisterApp = null;\n\tvar _hookRequireFunc = null;\n\n\tfunction Module(dependencies) {\n\t\tthis.dependencies = dependencies;\n\t\tthis.queueList = [];\n\t\tthis.routeList = [];\n\t\tthis.portalList = [];\n\t\tthis.widgetList = [];\n\n\t\tthis.requireRest = 0;\n\t\tthis.requireDeferred = null;\n\n\t\treturn this;\n\t}\n\n\t// GRUNT REPLACEMENT: Module.buildTimestamp = TIMESTAMP\n\twindow._TRS = function() {\n\t\treturn Module.buildTimestamp || Math.random();\n\t};\n\n\tModule.prototype.service = function () {\n\t\tthis.queueList.push({type: \"service\", args: arguments});\n\t\treturn this;\n\t};\n\tModule.prototype.directive = function () {\n\t\tthis.queueList.push({type: \"directive\", args: arguments});\n\t\treturn this;\n\t};\n\tModule.prototype.controller = function () {\n\t\tthis.queueList.push({type: \"controller\", args: arguments});\n\t\treturn this;\n\t};\n\n\t/**\n\t * Add portal into side navigation bar.\n\t * @param {{}} portal\t\t\t\tConfig portal content\n\t * @param {string} portal.name\t\tDisplay name\n\t * @param {string} portal.icon\t\tDisplay icon. Use 'FontAwesome'\n\t * @param {string=} portal.path\t\tRoute path\n\t * @param {[]=} portal.list\t\t\tSub portal\n\t * @param {boolean} isSite\t\t\ttrue will show in site page or will shown in main page\n\t */\n\tModule.prototype.portal = function (portal, isSite) {\n\t\tthis.portalList.push({portal: portal, isSite: isSite});\n\t\treturn this;\n\t};\n\n\t/**\n\t * Set application route\n\t * @param {{}|string=} state\t\t\t\tConfig state. More info please check angular ui router\n\t * @param {{}} config\t\t\t\t\t\tRoute config\n\t * @param {string} config.url\t\t\t\tRoot url. start with '/'\n\t * @param {string} config.templateUrl\t\tTemplate url. Relative path of application `viewPath`\n\t * @param {string} config.controller\t\tSet page controller\n\t */\n\tModule.prototype.route = function (state, config) {\n\t\tif(arguments.length === 1) {\n\t\t\tconfig = state;\n\t\t\tstate = \"_APPLICATION_STATE_\" + _moduleStateId++;\n\t\t}\n\n\t\tif(!config.url) throw \"Url not defined!\";\n\n\t\tthis.routeList.push({\n\t\t\tstate: state,\n\t\t\tconfig: config\n\t\t});\n\t\treturn this;\n\t};\n\n\t/**\n\t * Register home page widget\n\t * @param {string} name\t\t\t\tWidget name\n\t * @param {Function} renderFunc\t\tRegister function\n\t * @param {boolean} isSite\t\t\ttrue will show in site page or will shown in main page\n\t */\n\tModule.prototype.widget = function (name, renderFunc, isSite) {\n\t\tthis.widgetList.push({\n\t\t\twidget: {\n\t\t\t\tname: name,\n\t\t\t\trenderFunc: renderFunc\n\t\t\t},\n\t\t\tisSite: isSite\n\t\t});\n\t\treturn this;\n\t};\n\n\tModule.prototype.require = function (scriptURL) {\n\t\tvar _this = this;\n\n\t\t_this.requireRest += 1;\n\t\tif(!_this.requireDeferred) {\n\t\t\t_this.requireDeferred = $.Deferred();\n\t\t}\n\n\t\tsetTimeout(function () {\n\t\t\t$.getScript(_this.baseURL + \"/\" + scriptURL).then(function () {\n\t\t\t\tif(_hookRequireFunc) {\n\t\t\t\t\t_hookRequireFunc(_this);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(\"Hook function not set!\", _this);\n\t\t\t\t}\n\t\t\t}).always(function () {\n\t\t\t\t_hookRequireFunc = null;\n\t\t\t\t_this.requireRest -= 1;\n\t\t\t\t_this.requireCheck();\n\t\t\t});\n\t\t}, 0);\n\t};\n\n\tModule.prototype.requireCSS = function (styleURL) {\n\t\tvar _this = this;\n\t\tsetTimeout(function () {\n\t\t\t$(\"<link/>\", {\n\t\t\t\trel: \"stylesheet\",\n\t\t\t\ttype: \"text/css\",\n\t\t\t\thref: _this.baseURL + \"/\" + styleURL + \"?_=\" + _TRS()\n\t\t\t}).appendTo(\"head\");\n\t\t}, 0);\n\t};\n\n\tModule.prototype.requireCheck = function () {\n\t\tif(this.requireRest === 0) {\n\t\t\tthis.requireDeferred.resolve();\n\t\t}\n\t};\n\n\t/**\n\t * Get module instance. Will init angular module.\n\t * @param {string} moduleName\tangular module name\n\t */\n\tModule.prototype.getInstance = function (moduleName) {\n\t\tvar _this = this;\n\t\tvar deferred = $.Deferred();\n\t\tvar module = angular.module(moduleName, this.dependencies);\n\n\t\t// Required list\n\t\t$.when(this.requireDeferred).always(function () {\n\t\t\t// Fill module props\n\t\t\t$.each(_this.queueList, function (i, item) {\n\t\t\t\tvar type = item.type;\n\t\t\t\tvar args = Array.prototype.slice.apply(item.args);\n\t\t\t\tif (type === \"controller\") {\n\t\t\t\t\targs[0] = moduleName + \"_\" + args[0];\n\t\t\t\t}\n\t\t\t\tmodule[type].apply(module, args);\n\t\t\t});\n\n\t\t\t// Render routes\n\t\t\tvar routeList = $.map(_this.routeList, function (route) {\n\t\t\t\tvar config = route.config = $.extend({}, route.config);\n\n\t\t\t\t// Parse url\n\t\t\t\tif(config.site) {\n\t\t\t\t\tconfig.url = \"/site/:siteId/\" + config.url.replace(/^[\\\\\\/]/, \"\");\n\t\t\t\t}\n\n\t\t\t\t// Parse template url\n\t\t\t\tvar parser = document.createElement('a');\n\t\t\t\tparser.href = _this.baseURL + \"/\" + config.templateUrl;\n\t\t\t\tparser.search = parser.search ? parser.search + \"&_=\" + window._TRS() : \"?_=\" + window._TRS();\n\t\t\t\tconfig.templateUrl = parser.href;\n\n\t\t\t\tif (typeof config.controller === \"string\") {\n\t\t\t\t\tconfig.controller = moduleName + \"_\" + config.controller;\n\t\t\t\t}\n\n\t\t\t\treturn route;\n\t\t\t});\n\n\t\t\t// Portal update\n\t\t\t$.each(_this.portalList, function (i, config) {\n\t\t\t\tconfig.portal.application = moduleName;\n\t\t\t});\n\n\t\t\t// Widget update\n\t\t\t$.each(_this.widgetList, function (i, config) {\n\t\t\t\tconfig.widget.application = moduleName;\n\t\t\t});\n\n\t\t\tdeferred.resolve({\n\t\t\t\tapplication: moduleName,\n\t\t\t\tportalList: _this.portalList,\n\t\t\t\trouteList: routeList,\n\t\t\t\twidgetList: _this.widgetList\n\t\t\t});\n\t\t});\n\n\t\treturn deferred;\n\t};\n\n\twindow.register = function (dependencies) {\n\t\tif($.isArray(dependencies)) {\n\t\t\t_lastRegisterApp = new Module(dependencies);\n\t\t} else if(typeof dependencies === \"function\") {\n\t\t\t_hookRequireFunc = function (module) {\n\t\t\t\tdependencies(module);\n\t\t\t};\n\t\t}\n\t\treturn _lastRegisterApp;\n\t};\n\n\t// ======================================================================================\n\t// =                                        Main                                        =\n\t// ======================================================================================\n\t$(function () {\n\t\tconsole.info(\"[Eagle] Application initialization...\");\n\n\t\t// Load providers\n\t\t$.get(_host + \"/rest/apps/providers\").then(function (res) {\n\t\t\t/**\n\t\t\t * @param {{}} oriApp\t\t\t\t\tapplication provider\n\t\t\t * @param {string} oriApp.viewPath\t\tpath of application interface\n\t\t\t */\n\t\t\tvar promiseList = $.map(res.data || [], function (oriApp) {\n\t\t\t\tvar deferred = $.Deferred();\n\t\t\t\tvar viewPath = common.getValueByPath(_app, [oriApp.type, \"viewPath\"], oriApp.viewPath);\n\n\t\t\t\tif(viewPath) {\n\t\t\t\t\tvar url = viewPath;\n\t\t\t\t\turl = url.replace(/^[\\\\\\/]/, \"\").replace(/[\\\\\\/]$/, \"\");\n\n\t\t\t\t\t$.getScript(url + \"/index.js\").then(function () {\n\t\t\t\t\t\tif(_lastRegisterApp) {\n\t\t\t\t\t\t\t_registerAppList.push(oriApp.type);\n\t\t\t\t\t\t\t_lastRegisterApp.baseURL = url;\n\t\t\t\t\t\t\t_lastRegisterApp.getInstance(oriApp.type).then(function (module) {\n\t\t\t\t\t\t\t\tdeferred.resolve(module);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error(\"Application not register:\", oriApp.type);\n\t\t\t\t\t\t\tdeferred.resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\tconsole.error(\"Load application failed:\", oriApp.type, viewPath);\n\t\t\t\t\t\tdeferred.resolve();\n\t\t\t\t\t}).always(function () {\n\t\t\t\t\t\t_lastRegisterApp = null;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t}\n\n\t\t\t\treturn deferred;\n\t\t\t});\n\n\t\t\tcommon.deferred.all(promiseList).then(function (moduleList) {\n\t\t\t\t// Filter module list\n\t\t\t\tmoduleList = $.map(moduleList, function (module) {\n\t\t\t\t\treturn module;\n\t\t\t\t});\n\n\t\t\t\tvar routeList = $.map(moduleList, function (module) {\n\t\t\t\t\treturn module.routeList;\n\t\t\t\t});\n\t\t\t\tvar portalList = $.map(moduleList, function (module) {\n\t\t\t\t\treturn module.portalList;\n\t\t\t\t});\n\t\t\t\tvar widgetList = $.map(moduleList, function (module) {\n\t\t\t\t\treturn module.widgetList;\n\t\t\t\t});\n\n\t\t\t\t$(document).trigger(\"APPLICATION_READY\", {\n\t\t\t\t\tappList: _registerAppList,\n\t\t\t\t\tmoduleList: moduleList,\n\t\t\t\t\trouteList: routeList,\n\t\t\t\t\tportalList: portalList,\n\t\t\t\t\twidgetList: widgetList\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar app = {};\n\n(function() {\n\t'use strict';\n\n\t$(document).on(\"APPLICATION_READY\", function (event, register) {\n\t\tconsole.info(\"[Eagle] Angular bootstrap...\");\n\n\t\tvar STATE_NAME_MATCH = /^[^.]*/;\n\t\tvar state_next;\n\t\tvar state_current;\n\t\tvar param_next;\n\t\tvar param_current;\n\n\t\tvar modules = {};\n\t\t$.each(register.moduleList, function (i, module) {\n\t\t\tmodules[module.application] = module;\n\t\t});\n\n\t\t// ======================================================================================\n\t\t// =                                   Initialization                                   =\n\t\t// ======================================================================================\n\t\tvar eagleApp = angular.module('eagleApp', ['ngRoute', 'ngAnimate', 'ui.router', 'eagleControllers', 'eagle.service'].concat(register.appList));\n\n\t\t// ======================================================================================\n\t\t// =                                   Router config                                    =\n\t\t// ======================================================================================\n\t\tfunction routeResolve(config) {\n\t\t\tvar resolve = {};\n\t\t\tif(config === false) return resolve;\n\n\t\t\tconfig = $.extend({\n\t\t\t\tauth: true,\n\t\t\t\tsite: true,\n\t\t\t\tapplication: true\n\t\t\t}, config);\n\n\t\t\tif(config.auth) {\n\t\t\t\t// TODO: need auth module\n\t\t\t}\n\n\t\t\tresolve.Site = function (Site) {\n\t\t\t\treturn Site.getPromise(config);\n\t\t\t};\n\n\t\t\tresolve.Application = function (Application) {\n\t\t\t\treturn Application.getPromise();\n\t\t\t};\n\n\t\t\tresolve._router = function (Site, $wrapState, $q) {\n\t\t\t\tvar name = state_next.name;\n\t\t\t\tvar siteId = param_next.siteId;\n\t\t\t\tif (siteId && name !== \"site\") {\n\t\t\t\t\treturn Site.getPromise(config).then(function () {\n\t\t\t\t\t\tvar match =  false;\n\t\t\t\t\t\t$.each(common.getValueByPath(Site.find(siteId), [\"applicationList\"]), function (i, app) {\n\t\t\t\t\t\t\tvar appType = app.descriptor.type;\n\t\t\t\t\t\t\tvar module = modules[appType];\n\t\t\t\t\t\t\tif(!module) return;\n\n\t\t\t\t\t\t\tif(common.array.find(name, module.routeList, [\"state\"])) {\n\t\t\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif(!match) {\n\t\t\t\t\t\t\tconsole.log(\"[Application] No route match:\", name);\n\t\t\t\t\t\t\t$wrapState.go(\"site\", {siteId: siteId});\n\t\t\t\t\t\t\treturn $q.reject(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tresolve.Time = function (Time) {\n\t\t\t\treturn Time.getPromise(config, state_next, param_next);\n\t\t\t};\n\n\t\t\treturn resolve;\n\t\t}\n\n\t\teagleApp.config(function ($stateProvider, $urlRouterProvider, $httpProvider, $animateProvider) {\n\t\t\t$urlRouterProvider.otherwise(\"/\");\n\t\t\t$stateProvider\n\t\t\t// ================================== Home ==================================\n\t\t\t\t.state('home', {\n\t\t\t\t\turl: \"/\",\n\t\t\t\t\ttemplateUrl: \"partials/home.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"homeCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('setup', {\n\t\t\t\t\turl: \"/setup\",\n\t\t\t\t\ttemplateUrl: \"partials/setup.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"setupCtrl\",\n\t\t\t\t\tresolve: routeResolve({ site: false, application: false })\n\t\t\t\t})\n\t\t\t\t// ================================= Alerts =================================\n\t\t\t\t.state('alertList', {\n\t\t\t\t\turl: \"/alerts\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/list.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"alertListCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('policyList', {\n\t\t\t\t\turl: \"/policies\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/policyList.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"policyListCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('streamList', {\n\t\t\t\t\turl: \"/streams\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/streamList.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"alertStreamListCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('policyCreate', {\n\t\t\t\t\turl: \"/policy/create\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/policyEdit/main.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"policyCreateCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('policyEdit', {\n\t\t\t\t\turl: \"/policy/edit/{name}\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/policyEdit/main.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"policyEditCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\n\t\t\t\t.state('alertDetail', {\n\t\t\t\t\turl: \"/alert/detail/{alertId}\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/detail.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"alertDetailCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t\t.state('policyDetail', {\n\t\t\t\t\turl: \"/policy/detail/{name}\",\n\t\t\t\t\ttemplateUrl: \"partials/alert/policyDetail.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"policyDetailCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\n\t\t\t\t// =============================== Integration ==============================\n\t\t\t\t.state('integration', {\n\t\t\t\t\tabstract: true,\n\t\t\t\t\turl: \"/integration/\",\n\t\t\t\t\ttemplateUrl: \"partials/integration/main.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"integrationCtrl\",\n\t\t\t\t\tresolve: routeResolve(false)\n\t\t\t\t})\n\t\t\t\t.state('integration.siteList', {\n\t\t\t\t\turl: \"siteList\",\n\t\t\t\t\ttemplateUrl: \"partials/integration/siteList.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"integrationSiteListCtrl\",\n\t\t\t\t\tresolve: routeResolve({ application: false })\n\t\t\t\t})\n\t\t\t\t.state('integration.site', {\n\t\t\t\t\turl: \"site/:id\",\n\t\t\t\t\ttemplateUrl: \"partials/integration/site.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"integrationSiteCtrl\",\n\t\t\t\t\tresolve: routeResolve({ application: false })\n\t\t\t\t})\n\t\t\t\t.state('integration.applicationList', {\n\t\t\t\t\turl: \"applicationList\",\n\t\t\t\t\ttemplateUrl: \"partials/integration/applicationList.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"integrationApplicationListCtrl\",\n\t\t\t\t\tresolve: routeResolve({ application: false })\n\t\t\t\t})\n\n\t\t\t\t// ================================== Site ==================================\n\t\t\t\t.state('site', {\n\t\t\t\t\turl: \"/site/:siteId\",\n\t\t\t\t\ttemplateUrl: \"partials/site/home.html?_=\" + window._TRS(),\n\t\t\t\t\tcontroller: \"siteCtrl\",\n\t\t\t\t\tresolve: routeResolve()\n\t\t\t\t})\n\t\t\t;\n\n\t\t\t// =========================== Application States ===========================\n\t\t\t$.each(register.routeList, function (i, route) {\n\t\t\t\tvar config = $.extend({}, route.config);\n\n\t\t\t\tvar resolve = {};\n\t\t\t\tvar resolveConfig = {};\n\t\t\t\tif(route.config.resolve) {\n\t\t\t\t\t$.each(route.config.resolve, function (key, value) {\n\t\t\t\t\t\tif (typeof value === \"function\") {\n\t\t\t\t\t\t\tresolve[key] = value;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolveConfig[key] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tconfig.resolve = $.extend(routeResolve(resolveConfig), resolve);\n\n\t\t\t\t$stateProvider.state(route.state, config);\n\t\t\t});\n\n\t\t\t/* $httpProvider.interceptors.push(function($q) {\n\t\t\t\tfunction eagleRequestHandle(res) {\n\t\t\t\t\tvar data = res.data || {\n\t\t\t\t\t\texception: \"\",\n\t\t\t\t\t\tmessage: \"\"\n\t\t\t\t\t};\n\t\t\t\t\tif(res.status === -1) {\n\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\ttitle: \"AJAX Failed\",\n\t\t\t\t\t\t\tcontent: $(\"<pre>\")\n\t\t\t\t\t\t\t\t.text(\"url:\\n\" + common.getValueByPath(res, [\"config\", \"url\"]))\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if(data.success === false || res.status === 404) {\n\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\ttitle: \"AJAX Error\",\n\t\t\t\t\t\t\tcontent: $(\"<pre>\")\n\t\t\t\t\t\t\t\t.text(\n\t\t\t\t\t\t\t\t\t\"url:\\n\" + common.getValueByPath(res, [\"config\", \"url\"]) + \"\\n\\n\" +\n\t\t\t\t\t\t\t\t\t\"status:\\n\" + res.status + \"\\n\\n\" +\n\t\t\t\t\t\t\t\t\t\"exception:\\n\" + data.exception + \"\\n\\n\" +\n\t\t\t\t\t\t\t\t\t\"message:\\n\" + data.message\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tresponse: eagleRequestHandle,\n\t\t\t\t\tresponseError: function(res) {\n\t\t\t\t\t\treturn $q.reject(eagleRequestHandle(res));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}); */\n\t\t});\n\n\t\t// ======================================================================================\n\t\t// =                                   Main Controller                                  =\n\t\t// ======================================================================================\n\t\teagleApp.controller('MainCtrl', function ($scope, $wrapState, $urlRouter, PageConfig, Portal, Widget, Entity, Site, Application, UI, Time, Policy) {\n\t\t\twindow._WrapState = $scope.$wrapState = $wrapState;\n\t\t\twindow._PageConfig = $scope.PageConfig = PageConfig;\n\t\t\twindow._Portal = $scope.Portal = Portal;\n\t\t\twindow._Widget = $scope.Widget = Widget;\n\t\t\twindow._Entity = $scope.Entity = Entity;\n\t\t\twindow._Site = $scope.Site = Site;\n\t\t\twindow._Application = $scope.Application = Application;\n\t\t\twindow._UI = $scope.UI = UI;\n\t\t\twindow._Time = $scope.Time = Time;\n\t\t\twindow._Policy = $scope.Policy = Policy;\n\t\t\t$scope.common = common;\n\n\t\t\t$scope._TRS = window._TRS();\n\n\t\t\tObject.defineProperty(window, \"scope\", {\n\t\t\t\tget: function () {\n\t\t\t\t\tvar ele = $(\"#content .nav-tabs-custom.ng-scope .ng-scope[ui-view], #content .ng-scope[ui-view]\").last();\n\t\t\t\t\treturn angular.element(ele).scope();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// ============================== Route Update ==============================\n\t\t\t$scope.$on('$stateChangeStart', function (event, next, nextParam, current, currentParam) {\n\t\t\t\tconsole.log(\"[Switch] current ->\", current, currentParam);\n\t\t\t\tconsole.log(\"[Switch] next ->\", next, nextParam);\n\n\t\t\t\tstate_next = next || {};\n\t\t\t\tstate_current = current || {};\n\t\t\t\tparam_next = nextParam;\n\t\t\t\tparam_current = currentParam;\n\n\t\t\t\tvar currentName = (current || {}).name || \"\";\n\t\t\t\tvar nextName = (next || {}).name || \"\";\n\n\t\t\t\t// Page initialization\n\t\t\t\tif(currentName.match(STATE_NAME_MATCH)[0] !== nextName.match(STATE_NAME_MATCH)[0]) {\n\t\t\t\t\tPageConfig.reset();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$scope.$on('$stateChangeSuccess', function (event) {\n\t\t\t\tvar _innerSearch = Time._innerSearch;\n\t\t\t\tTime._innerSearch = null;\n\t\t\t\tif(_innerSearch) {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t$wrapState.go(\".\", $.extend({}, $wrapState.param, _innerSearch), {location: \"replace\", notify: false});\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t\tconsole.log(\"[Switch] done ->\", event);\n\t\t\t});\n\n\t\t\t// ================================ Function ================================\n\t\t\t// Get side bar navigation item class\n\t\t\t$scope.getNavClass = function (portal) {\n\t\t\t\tvar path = (portal.path || \"\").replace(/^#/, '');\n\n\t\t\t\tif ($wrapState.path() === path) {\n\t\t\t\t\treturn \"active\";\n\t\t\t\t} else {\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Customize time range\n\t\t\t$scope.customizeTimeRange = function () {\n\t\t\t\t$(\"#eagleStartTime\").val(Time.format(\"startTime\"));\n\t\t\t\t$(\"#eagleEndTime\").val(Time.format(\"endTime\"));\n\t\t\t\t$(\"#eagleTimeRangeMDL\").modal();\n\t\t\t};\n\n\t\t\t$scope.setLastDuration = function (hours) {\n\t\t\t\tvar endTime = new Time();\n\t\t\t\tvar startTime = endTime.clone().subtract(hours, \"hours\");\n\t\t\t\tTime.timeRange(startTime, endTime);\n\t\t\t};\n\n\t\t\t$scope.updateTimeRange = function () {\n\t\t\t\tvar startTime = Time.verifyTime($(\"#eagleStartTime\").val());\n\t\t\t\tvar endTime = Time.verifyTime($(\"#eagleEndTime\").val());\n\t\t\t\tif(startTime && endTime) {\n\t\t\t\t\tTime.timeRange(startTime, endTime);\n\t\t\t\t\t$(\"#eagleTimeRangeMDL\").modal(\"hide\");\n\t\t\t\t} else {\n\t\t\t\t\talert(\"Time range not validate\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// ================================== Init ==================================\n\t\t\t$.each(register.portalList, function (i, config) {\n\t\t\t\tPortal.register(config.portal, config.isSite);\n\t\t\t});\n\n\t\t\t$.each(register.widgetList, function (i, config) {\n\t\t\t\tWidget.register(config.widget, config.isSite);\n\t\t\t});\n\t\t});\n\n\t\t// ======================================================================================\n\t\t// =                                      Bootstrap                                     =\n\t\t// ======================================================================================\n\t\t//noinspection JSCheckFunctionSignatures\n\t\tangular.element(document).ready(function() {\n\t\t\tconsole.info(\"[Eagle] UI start...\");\n\n\t\t\t//noinspection JSCheckFunctionSignatures\n\t\t\tangular.bootstrap(document, ['eagleApp']);\n\n\t\t\t$(\"body\").removeClass(\"ng-init-lock\");\n\t\t\t$(\"#appLoadTip\").remove();\n\t\t});\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleSrv = angular.module('eagle.service', []);\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar UNITS = [\n\t\t[\"days\", \"day\", \"day\"],\n\t\t[\"hours\", \"hr\", \"hr\"],\n\t\t[\"minutes\", \"min\", \"min\"],\n\t\t[\"seconds\", \"s\", \"s\"]\n\t];\n\n\tvar keepTime = false;\n\tvar serviceModule = angular.module('eagle.service');\n\n\tserviceModule.service('Time', function($q, $wrapState) {\n\t\tvar startTime, endTime;\n\t\tvar reloadListenerList = [];\n\n\t\tvar $Time = function (time) {\n\t\t\tvar _mom;\n\n\t\t\tif(arguments.length === 1 && time === undefined) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tswitch (time) {\n\t\t\t\tcase \"startTime\":\n\t\t\t\t\treturn startTime;\n\t\t\t\tcase \"endTime\":\n\t\t\t\t\treturn endTime;\n\t\t\t\tcase \"month\":\n\t\t\t\t\t_mom = new moment();\n\t\t\t\t\t_mom.utcOffset($Time.UTC_OFFSET);\n\t\t\t\t\t_mom.date(1).hours(0).minutes(0).seconds(0).millisecond(0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"monthEnd\":\n\t\t\t\t\t_mom = $Time(\"month\").add(1, \"month\").subtract(1, \"s\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"week\":\n\t\t\t\t\t_mom = new moment();\n\t\t\t\t\t_mom.utcOffset($Time.UTC_OFFSET);\n\t\t\t\t\t_mom.weekday(0).hours(0).minutes(0).seconds(0).millisecond(0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"weekEnd\":\n\t\t\t\t\t_mom = $Time(\"week\").add(7, \"d\").subtract(1, \"s\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"day\":\n\t\t\t\t\t_mom = new moment();\n\t\t\t\t\t_mom.utcOffset($Time.UTC_OFFSET);\n\t\t\t\t\t_mom.hours(0).minutes(0).seconds(0).millisecond(0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"dayEnd\":\n\t\t\t\t\t_mom = $Time(\"day\").add(1, \"d\").subtract(1, \"s\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hour\":\n\t\t\t\t\t_mom = new moment();\n\t\t\t\t\t_mom.utcOffset($Time.UTC_OFFSET);\n\t\t\t\t\t_mom.minutes(0).seconds(0).millisecond(0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hourEnd\":\n\t\t\t\t\t_mom = $Time(\"hour\").add(1, \"h\").subtract(1, \"s\");\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// Parse string number\n\t\t\t\t\tif(typeof time === \"string\") {\n\t\t\t\t\t\tif(!isNaN(+time)) {\n\t\t\t\t\t\t\ttime = +time;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttime = new moment(time);\n\t\t\t\t\t\t\ttime.add(time.utcOffset(), \"minutes\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t_mom = new moment(time);\n\t\t\t\t\t_mom.utcOffset($Time.UTC_OFFSET);\n\t\t\t}\n\t\t\treturn _mom;\n\t\t};\n\n\t\t$Time.TIME_RANGE_PICKER = \"timeRange\";\n\t\t$Time.pickerType = null;\n\t\t$Time._reloadListenerList = reloadListenerList;\n\n\t\t// TODO: time zone\n\t\t$Time.UTC_OFFSET = 0;\n\n\t\t$Time.FORMAT = \"YYYY-MM-DD HH:mm:ss\";\n\t\t$Time.SHORT_FORMAT = \"MM-DD HH:mm\";\n\n\t\t$Time.format = function (time, format) {\n\t\t\ttime = $Time(time);\n\t\t\treturn time ? time.format(format || $Time.FORMAT) : \"-\";\n\t\t};\n\n\t\t$Time.startTime = function () {\n\t\t\treturn startTime;\n\t\t};\n\n\t\t$Time.endTime = function () {\n\t\t\treturn endTime;\n\t\t};\n\n\t\t$Time.timeRange = function (startTimeValue, endTimeValue) {\n\t\t\tstartTime = $Time(startTimeValue);\n\t\t\tendTime = $Time(endTimeValue);\n\n\t\t\tkeepTime = true;\n\t\t\t$wrapState.go(\".\", $.extend({}, $wrapState.param, {\n\t\t\t\tstartTime: $Time.format(startTime),\n\t\t\t\tendTime: $Time.format(endTime)\n\t\t\t}), {notify: false});\n\n\t\t\t$.each(reloadListenerList, function (i, listener) {\n\t\t\t\tlistener($Time);\n\t\t\t});\n\t\t};\n\n\t\t$Time.onReload = function (func, $scope) {\n\t\t\treloadListenerList.push(func);\n\n\t\t\t// Clean up\n\t\t\tif($scope) {\n\t\t\t\t$scope.$on('$destroy', function() {\n\t\t\t\t\t$Time.offReload(func);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t$Time.offReload = function (func) {\n\t\t\treloadListenerList = $.grep(reloadListenerList, function(_func) {\n\t\t\t\treturn _func !== func;\n\t\t\t});\n\t\t};\n\n\t\t$Time.verifyTime = function(str, format) {\n\t\t\tformat = format || $Time.FORMAT;\n\t\t\tvar date = $Time(str);\n\t\t\tif(str === $Time.format(date, format)) {\n\t\t\t\treturn date;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\t$Time.diff = function (from, to) {\n\t\t\tfrom = $Time(from);\n\t\t\tto = $Time(to);\n\t\t\tif (!from || !to) return null;\n\t\t\treturn to.diff(from);\n\t\t};\n\n\t\t$Time.diffStr = function (from, to) {\n\t\t\tvar diff = from;\n\t\t\tif(arguments.length === 2) {\n\t\t\t\tdiff = $Time.diff(from, to);\n\t\t\t}\n\t\t\tif(diff === null) return \"-\";\n\t\t\tif(diff === 0) return \"0s\";\n\n\t\t\tvar match = false;\n\t\t\tvar rows = [];\n\t\t\tvar duration = moment.duration(diff);\n\t\t\tvar rest = 3;\n\n\t\t\t$.each(UNITS, function (i, unit) {\n\t\t\t\tvar interval = Math.floor(duration[unit[0]]());\n\t\t\t\tif(interval > 0) match = true;\n\n\t\t\t\tif(match) {\n\t\t\t\t\tif(interval !== 0) {\n\t\t\t\t\t\trows.push(interval + (interval > 1 ? unit[1] : unit[2]));\n\t\t\t\t\t}\n\n\t\t\t\t\trest -=1;\n\t\t\t\t\tif(rest === 0) return false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn rows.join(\", \");\n\t\t};\n\n\t\t$Time.diffInterval = function (from, to) {\n\t\t\tvar timeDiff = $Time.diff(from, to);\n\t\t\tif(timeDiff <= 1000 * 60 * 60 * 6) {\n\t\t\t\treturn 1000 * 60 * 5;\n\t\t\t} else if(timeDiff <= 1000 * 60 * 60 * 24) {\n\t\t\t\treturn 1000 * 60 * 15;\n\t\t\t} else if(timeDiff <= 1000 * 60 * 60 * 24 * 7) {\n\t\t\t\treturn 1000 * 60 * 30;\n\t\t\t} else if(timeDiff <= 1000 * 60 * 60 * 24 * 14) {\n\t\t\t\treturn 1000 * 60 * 60;\n\t\t\t} else {\n\t\t\t\treturn 1000 * 60 * 60 * 24;\n\t\t\t}\n\t\t};\n\n\t\t$Time.align = function (time, interval, ceil) {\n\t\t\ttime = $Time(time);\n\t\t\tif(!time) return null;\n\n\t\t\tvar func = ceil ? Math.ceil : Math.floor;\n\n\t\t\tvar timestamp = time.valueOf();\n\t\t\treturn $Time(func(timestamp / interval) * interval);\n\t\t};\n\n\t\t$Time.millionFormat = function (num) {\n\t\t\tif(!num) return \"-\";\n\t\t\tnum = Math.floor(num / 1000);\n\t\t\tvar s = num % 60;\n\t\t\tnum = Math.floor(num / 60);\n\t\t\tvar m = num % 60;\n\t\t\tnum = Math.floor(num / 60);\n\t\t\tvar h = num % 60;\n\t\t\treturn common.string.preFill(h, \"0\") + \":\" +\n\t\t\t\tcommon.string.preFill(m, \"0\") + \":\" +\n\t\t\t\tcommon.string.preFill(s, \"0\");\n\t\t};\n\n\t\t$Time.getPromise = function (config, state, param) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tif(keepTime) {\n\t\t\t\tkeepTime = false;\n\t\t\t\tdeferred.resolve($Time);\n\t\t\t} else {\n\t\t\t\tif (config.time === true) {\n\t\t\t\t\t$Time.pickerType = $Time.TIME_RANGE_PICKER;\n\n\t\t\t\t\tstartTime = $Time.verifyTime(param.startTime);\n\t\t\t\t\tendTime = $Time.verifyTime(param.endTime);\n\n\t\t\t\t\tif (!startTime || !endTime) {\n\t\t\t\t\t\tendTime = $Time();\n\t\t\t\t\t\tstartTime = endTime.clone().subtract(2, \"hour\");\n\n\t\t\t\t\t\tkeepTime = true;\n\t\t\t\t\t\t$Time._innerSearch = {\n\t\t\t\t\t\t\tstartTime: $Time.format(startTime),\n\t\t\t\t\t\t\tendTime: $Time.format(endTime)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$Time._innerSearch = null;\n\t\t\t\t\t$Time.pickerType = null;\n\t\t\t\t}\n\t\t\t\tdeferred.resolve($Time);\n\t\t\t}\n\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\treturn $Time;\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\t// ============================================================\n\t// =                           Page                           =\n\t// ============================================================\n\tserviceModule.service('PageConfig', function() {\n\t\tfunction PageConfig() {\n\t\t}\n\n\t\tPageConfig.reset = function () {\n\t\t\tPageConfig.title = \"\";\n\t\t\tPageConfig.subTitle = \"\";\n\t\t\tPageConfig.navPath = [];\n\t\t\tPageConfig.hideTitle = false;\n\t\t};\n\n\t\treturn PageConfig;\n\t});\n\n\t// ============================================================\n\t// =                          Portal                          =\n\t// ============================================================\n\tserviceModule.service('Portal', function($wrapState, Site, Application) {\n\t\tfunction checkSite() {\n\t\t\treturn Site.list.length !== 0;\n\t\t}\n\n\t\tfunction checkApplication() {\n\t\t\treturn checkSite() && Application.list.length !== 0;\n\t\t}\n\n\t\tvar defaultPortalList = [\n\t\t\t{name: \"Home\", icon: \"home\", path: \"#/\"},\n\t\t\t{name: \"Alert\", icon: \"bell\", showFunc: checkApplication, list: [\n\t\t\t\t{name: \"Alerts\", path: \"#/alerts\"},\n\t\t\t\t{name: \"Policies\", path: \"#/policies\"},\n\t\t\t\t{name: \"Streams\", path: \"#/streams\"},\n\t\t\t\t{name: \"Define Policy\", path: \"#/policy/create\"}\n\t\t\t]}\n\t\t];\n\t\tvar adminPortalList = [\n\t\t\t{name: \"Integration\", icon: \"puzzle-piece\", showFunc: checkSite, list: [\n\t\t\t\t{name: \"Sites\", path: \"#/integration/siteList\"},\n\t\t\t\t{name: \"Applications\", path: \"#/integration/applicationList\"}\n\t\t\t]}\n\t\t];\n\n\t\tvar Portal = {};\n\n\t\tvar mainPortalList = [];\n\t\tvar sitePortalList = [];\n\t\tvar connectedMainPortalList = [];\n\t\tvar sitePortals = {};\n\n\t\tvar backHome = {name: \"Back\", icon: \"arrow-left\", path: \"#/\"};\n\n\t\tPortal.register = function (portal, isSite) {\n\t\t\t(isSite ? sitePortalList : mainPortalList).push(portal);\n\t\t};\n\n\t\tfunction convertSitePortal(site, portal) {\n\t\t\tportal = $.extend({}, portal, {\n\t\t\t\tpath: portal.path ? \"#/site/\" + site.siteId + \"/\" + portal.path.replace(/^[\\\\\\/]/, \"\") : null\n\t\t\t});\n\n\t\t\tif(portal.list) {\n\t\t\t\tportal.list = $.map(portal.list, function (portal) {\n\t\t\t\t\treturn convertSitePortal(site, portal);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn portal;\n\t\t}\n\n\t\tPortal.refresh = function () {\n\t\t\t// TODO: check admin\n\n\t\t\t// Main level\n\t\t\tconnectedMainPortalList = defaultPortalList.concat(adminPortalList);\n\t\t\tvar siteList = $.map(Site.list, function (site) {\n\t\t\t\treturn {\n\t\t\t\t\tname: site.siteName || site.siteId,\n\t\t\t\t\tpath: \"#/site/\" + site.siteId\n\t\t\t\t};\n\t\t\t});\n\t\t\tconnectedMainPortalList.push({name: \"Sites\", icon: \"server\", showFunc: checkApplication, list: siteList});\n\n\t\t\t// Site level\n\t\t\tsitePortals = {};\n\t\t\t$.each(Site.list, function (i, site) {\n\t\t\t\tvar siteHome = {name: site.siteName || site.siteId + \" Home\", icon: \"home\", path: \"#/site/\" + site.siteId};\n\t\t\t\tsitePortals[site.siteId] = [backHome, siteHome].concat($.map(sitePortalList, function (portal) {\n\t\t\t\t\tvar hasApp = !!common.array.find(portal.application, site.applicationList, \"descriptor.type\");\n\t\t\t\t\tif(hasApp) {\n\t\t\t\t\t\treturn convertSitePortal(site, portal);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t});\n\t\t};\n\n\t\tObject.defineProperty(Portal, 'list', {\n\t\t\tget: function () {\n\t\t\t\tvar match = $wrapState.path().match(/^\\/site\\/([^\\/]*)/);\n\t\t\t\tif(match && match[1]) {\n\t\t\t\t\treturn sitePortals[match[1]];\n\t\t\t\t} else {\n\t\t\t\t\treturn connectedMainPortalList;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\t// Initialization\n\t\tSite.onReload(Portal.refresh);\n\n\t\tPortal.refresh();\n\n\t\treturn Portal;\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tserviceModule.service('Widget', function($wrapState, Site, Application) {\n\t\tvar Widget = {};\n\n\t\tvar mainWidgetList = [];\n\t\tvar siteWidgetList = [];\n\n\t\tvar displayWidgetList = [];\n\t\tvar siteWidgets = {};\n\n\t\tWidget.register = function (widget, isSite) {\n\t\t\t(isSite ? siteWidgetList : mainWidgetList).push(widget);\n\t\t};\n\n\t\tWidget.refresh = function () {\n\t\t\t// Common widget\n\t\t\tdisplayWidgetList = $.map(mainWidgetList, function (widget) {\n\t\t\t\tvar hasApp = !!common.array.find(widget.application, Application.list, \"descriptor.type\");\n\t\t\t\tif(hasApp) {\n\t\t\t\t\treturn widget;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Site widget\n\t\t\tsiteWidgets = {};\n\t\t\t$.each(Site.list, function (i, site) {\n\t\t\t\tsiteWidgets[site.siteId] = $.map(siteWidgetList, function (widget) {\n\t\t\t\t\tvar hasApp = !!common.array.find(widget.application, site.applicationList, \"descriptor.type\");\n\t\t\t\t\tif(hasApp) {\n\t\t\t\t\t\treturn widget;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tObject.defineProperty(Widget, 'list', {\n\t\t\tget: function () {\n\t\t\t\tvar site = Site.current();\n\t\t\t\tif(!site) {\n\t\t\t\t\treturn displayWidgetList;\n\t\t\t\t} else if(site.siteId) {\n\t\t\t\t\treturn siteWidgets[site.siteId];\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Can't find current site id.\");\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Initialization\n\t\tSite.onReload(Widget.refresh);\n\n\t\tWidget.refresh();\n\n\t\treturn Widget;\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\tserviceModule.service('$wrapState', function($state, $location, $stateParams) {\n\t\tvar $wrapState = {};\n\t\tvar _targetState = null;\n\t\tvar _targetPriority = 0;\n\n\t\t// Go\n\t\t$wrapState.go = function(state, param, option, priority) {\n\t\t\tsetTimeout(function() {\n\t\t\t\t_targetState = null;\n\t\t\t\t_targetPriority = 0;\n\t\t\t});\n\n\t\t\tif(typeof param !== \"object\") {\n\t\t\t\tpriority = param;\n\t\t\t\tparam = {};\n\t\t\t\toption = {};\n\t\t\t} else if(typeof option !== \"object\") {\n\t\t\t\tpriority = option;\n\t\t\t\toption = {};\n\t\t\t}\n\n\t\t\tpriority = priority === true ? 1 : (priority || 0);\n\t\t\tif(_targetPriority > priority) {\n\t\t\t\tconsole.log(\"[Wrap State] Go - low priority:\", state, \"(Skip)\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif(_targetState !== state || priority) {\n\t\t\t\tif($state.current && $state.current.name === state && angular.equals($state.params, param)) {\n\t\t\t\t\tconsole.log(\"[Wrap State] Go reload.\", $state);\n\t\t\t\t\t$state.reload();\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"[Wrap State] Go:\", state, param, priority);\n\t\t\t\t\t$state.go(state, param, option);\n\t\t\t\t}\n\t\t\t\t_targetState = state;\n\t\t\t\t_targetPriority = priority;\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"[Wrap State] Go:\", state, \"(Ignored)\");\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t// Reload\n\t\t$wrapState.reload = function() {\n\t\t\tconsole.log(\"[Wrap State] Do reload.\");\n\t\t\t$state.reload();\n\t\t};\n\n\t\t// Path\n\t\t$wrapState.path = function(path) {\n\t\t\tif(path !== undefined) {\n\t\t\t\tconsole.log(\"[Wrap State][Deprecated] Switch path:\", path);\n\t\t\t}\n\t\t\treturn $location.path(path);\n\t\t};\n\n\t\t// URL\n\t\t$wrapState.url = function(url) {\n\t\t\tif(url !== undefined) console.log(\"[Wrap State] Switch url:\", url);\n\t\t\treturn $location.url(url);\n\t\t};\n\n\t\tObject.defineProperties($wrapState, {\n\t\t\t// Origin $state\n\t\t\torigin: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn $state;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Current\n\t\t\tcurrent: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn $state.current;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Parameter\n\t\t\tparam: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn $.extend({}, $location.search(), $stateParams);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// State\n\t\t\tstate: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn $state;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t$wrapState.search = $location.search.bind($location);\n\t\t$wrapState.$location = $location;\n\n\t\treturn $wrapState;\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tvar _host = \"\";\n\tif(localStorage) {\n\t\t_host = localStorage.getItem(\"host\") || \"\";\n\t}\n\n\tserviceModule.service('Entity', function($http, $q) {\n\t\tfunction Entity() {}\n\n\t\tfunction wrapList(list, promise) {\n\t\t\tlist._done = false;\n\t\t\tlist._promise = promise.then(function (res) {\n\t\t\t\tvar data = res.data;\n\t\t\t\tlist.splice(0);\n\t\t\t\tArray.prototype.push.apply(list, data.data);\n\t\t\t\tlist._done = true;\n\n\t\t\t\treturn res;\n\t\t\t});\n\t\t\treturn withThen(list);\n\t\t}\n\n\t\tfunction withThen(list) {\n\t\t\tlist._then = list._promise.then.bind(list._promise);\n\t\t\treturn list;\n\t\t}\n\n\t\t// Dev usage. Set rest api source\n\t\tEntity._host = function (host) {\n\t\t\tconsole.warn(\"This function only used for development usage.\");\n\t\t\tif(host) {\n\t\t\t\t_host = host.replace(/[\\\\\\/]+$/, \"\");\n\t\t\t\tif(localStorage) {\n\t\t\t\t\tlocalStorage.setItem(\"host\", _host);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn _host;\n\t\t};\n\n\t\tEntity.query = function (url, param) {\n\t\t\tvar list = [];\n\t\t\tlist._refresh = function () {\n\t\t\t\tvar config = {};\n\t\t\t\tif(param) config.params = param;\n\t\t\t\treturn wrapList(list, $http.get(_host + \"/rest/\" + url, config));\n\t\t\t};\n\n\t\t\treturn list._refresh();\n\t\t};\n\n\t\tEntity.create = Entity.post = function (url, entity) {\n\t\t\tvar list = [];\n\t\t\treturn wrapList(list, $http({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: _host + \"/rest/\" + url,\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t\t},\n\t\t\t\tdata: entity\n\t\t\t}));\n\t\t};\n\n\t\tEntity.delete = function (url, uuid) {\n\t\t\tvar list = [];\n\t\t\treturn wrapList(list, $http({\n\t\t\t\tmethod: 'DELETE',\n\t\t\t\turl: _host + \"/rest/\" + url,\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t\t},\n\t\t\t\tdata: {uuid: uuid}\n\t\t\t}));\n\t\t};\n\n\t\t/**\n\t\t * Merge 2 array into one. Will return origin list before target list is ready. Then fill with target list.\n\t\t * @param oriList\n\t\t * @param tgtList\n\t\t * @return {[]}\n\t\t */\n\t\tEntity.merge = function (oriList, tgtList) {\n\t\t\toriList = oriList || [];\n\n\t\t\tvar list = [].concat(oriList);\n\t\t\tlist._done = tgtList._done;\n\t\t\tlist._refresh = tgtList._refresh;\n\t\t\tlist._promise = tgtList._promise;\n\n\t\t\tlist._promise.then(function () {\n\t\t\t\tlist.splice(0);\n\t\t\t\tArray.prototype.push.apply(list, tgtList);\n\t\t\t\tlist._done = true;\n\t\t\t});\n\n\t\t\tlist = withThen(list);\n\n\t\t\treturn list;\n\t\t};\n\n\t\t// TODO: metadata will be removed\n\t\tEntity.queryMetadata = function (url, param) {\n\t\t\tvar metaList = Entity.query('metadata/' +  url, param);\n\t\t\tvar _refresh = metaList._refresh;\n\n\t\t\tfunction process() {\n\t\t\t\tmetaList._then(function (res) {\n\t\t\t\t\tvar data = res.data;\n\t\t\t\t\tif(!$.isArray(data)) {\n\t\t\t\t\t\tdata = [data];\n\t\t\t\t\t}\n\n\t\t\t\t\tmetaList.splice(0);\n\t\t\t\t\tArray.prototype.push.apply(metaList, data);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tmetaList._refresh = function () {\n\t\t\t\t_refresh();\n\t\t\t\tprocess();\n\t\t\t};\n\n\t\t\tprocess();\n\n\t\t\treturn metaList;\n\t\t};\n\n\t\tEntity.deleteMetadata = function (url) {\n\t\t\treturn {\n\t\t\t\t_promise: $http.delete(_host + \"/rest/metadata/\" + url).then(function (res) {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t})\n\t\t\t};\n\t\t};\n\n\t\treturn Entity;\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tserviceModule.service('Site', function($q, $wrapState, Entity, Application) {\n\t\tvar Site = {};\n\t\tvar reloadListenerList = [];\n\n\t\tSite.list = [];\n\n\t\t// Link with application\n\t\tfunction linkApplications(siteList, ApplicationList) {\n\t\t\t$.each(siteList, function (i, site) {\n\t\t\t\tvar applications = common.array.find(site.siteId, ApplicationList, 'site.siteId', true);\n\n\t\t\t\t$.each(applications, function (i, app) {\n\t\t\t\t\tapp.descriptor = app.descriptor || {};\n\t\t\t\t\tvar oriApp = Application.providers[app.descriptor.type];\n\t\t\t\t\tObject.defineProperty(app, 'origin', {\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\treturn oriApp;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tObject.defineProperties(site, {\n\t\t\t\t\tapplicationList: {\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\treturn applications;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// Load sites\n\t\tSite.reload = function () {\n\t\t\tvar list = Site.list = Entity.query('sites');\n\t\t\tlist._promise.then(function () {\n\t\t\t\tlinkApplications(list, Application.list);\n\t\t\t\t$.each(reloadListenerList, function (i, listener) {\n\t\t\t\t\tlistener(Site);\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn Site;\n\t\t};\n\n\t\tSite.onReload = function (func) {\n\t\t\treloadListenerList.push(func);\n\t\t};\n\n\t\t// Find Site\n\t\tSite.find = function (siteId) {\n\t\t\treturn common.array.find(siteId, Site.list, 'siteId');\n\t\t};\n\n\t\tSite.current = function () {\n\t\t\treturn Site.find($wrapState.param.siteId);\n\t\t};\n\n\t\tSite.switchSite = function (site) {\n\t\t\tvar param = $wrapState.param;\n\t\t\tif(!site) {\n\t\t\t\t$wrapState.go(\"home\");\n\t\t\t} else if(param.siteId) {\n\t\t\t\t$wrapState.go($wrapState.current.name, $.extend({}, param, {siteId: site.siteId}));\n\t\t\t} else {\n\t\t\t\t$wrapState.go(\"site\", {siteId: site.siteId});\n\t\t\t}\n\t\t};\n\n\t\tSite.getPromise = function (config) {\n\t\t\tvar siteList = Site.list;\n\n\t\t\treturn $q.all([siteList._promise, Application.getPromise()]).then(function() {\n\t\t\t\t// Site check\n\t\t\t\tif(config && config.site !== false && siteList.length === 0) {\n\t\t\t\t\t$wrapState.go('setup', 1);\n\t\t\t\t\treturn $q.reject(Site);\n\t\t\t\t}\n\n\t\t\t\t// Application check\n\t\t\t\tif(config && config.application !== false && Application.list.length === 0) {\n\t\t\t\t\t$wrapState.go('integration.site', {id: siteList[0].siteId}, 1);\n\t\t\t\t\treturn $q.reject(Site);\n\t\t\t\t}\n\n\t\t\t\treturn Site;\n\t\t\t});\n\t\t};\n\n\t\t// Initialization\n\t\tApplication.onReload(function () {\n\t\t\tSite.reload();\n\t\t});\n\n\t\tSite.reload();\n\n\t\treturn Site;\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tserviceModule.service('Application', function($q, $wrapState, Entity) {\n\t\tvar Application = {};\n\t\tvar reloadListenerList = [];\n\n\t\tApplication.list = [];\n\n\t\tApplication.find = function (type, site) {\n\t\t\treturn $.grep(Application.list, function (app) {\n\t\t\t\treturn app.descriptor.type === type && (site ? app.site.siteId === site : true);\n\t\t\t});\n\t\t};\n\n\t\t// Load applications\n\t\tApplication.reload = function () {\n\t\t\tApplication.list = Entity.query('apps');\n\t\t\tApplication.list._then(function () {\n\t\t\t\t$.each(reloadListenerList, function (i, listener) {\n\t\t\t\t\tlistener(Application);\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn Application;\n\t\t};\n\n\t\tApplication.onReload = function (func) {\n\t\t\treloadListenerList.push(func);\n\t\t};\n\n\t\t// Load providers\n\t\tApplication.providers = {};\n\t\tApplication.providerList = Entity.query('apps/providers');\n\t\tApplication.providerList._promise.then(function () {\n\t\t\t$.each(Application.providerList, function (i, oriApp) {\n\t\t\t\tApplication.providers[oriApp.type] = oriApp;\n\t\t\t});\n\t\t});\n\n\t\tApplication.findProvider = function (type) {\n\t\t\tvar provider = common.array.find(type, Application.providerList, [\"type\"]);\n\t\t\tif(provider) return provider;\n\n\t\t\tvar app = common.array.find(type, Application.list, [\"appId\"]);\n\t\t\tif(!app || !app.descriptor) return null;\n\n\t\t\treturn common.array.find(app.descriptor.type, Application.providerList, [\"type\"]);\n\t\t};\n\n\t\tApplication.getPromise = function () {\n\t\t\treturn Application.list._promise.then(function() {\n\t\t\t\treturn Application;\n\t\t\t});\n\t\t};\n\n\t\t// Initialization\n\t\tApplication.reload();\n\n\t\treturn Application;\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tfunction wrapPromise(promise) {\n\t\tvar retFunc = function (notifyFunc, resolveFunc, rejectFunc) {\n\t\t\tpromise.then(resolveFunc, rejectFunc, function (holder) {\n\t\t\t\tnotifyFunc(holder.entity, holder.closeFunc, holder.unlock);\n\t\t\t});\n\t\t};\n\n\t\tretFunc.then = promise.then;\n\n\t\treturn retFunc;\n\t}\n\n\t/**\n\t * Check function to check fields pass or not\n\t * @callback checkFieldFunction\n\t * @param {{}} entity\n\t * @return {string}\n\t */\n\n\tserviceModule.service('UI', function($rootScope, $q, $compile) {\n\t\tfunction UI() {}\n\n\t\tfunction _bindShortcut($dialog) {\n\t\t\t$dialog.on(\"keydown\", function (event) {\n\t\t\t\tif(event.which === 13) {\n\t\t\t\t\tif(!$(\":focus\").is(\"textarea\")) {\n\t\t\t\t\t\t$dialog.find(\".confirmBtn:enabled\").click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction _fieldDialog(create, name, entity, fieldList, checkFunc) {\n\t\t\tvar _deferred, $mdl, $scope;\n\n\t\t\tvar _entity = entity || {};\n\n\t\t\t_deferred = $q.defer();\n\t\t\t$scope = $rootScope.$new(true);\n\t\t\t$scope.name = name;\n\t\t\t$scope.entity = _entity;\n\t\t\t$scope.fieldList = fieldList.concat();\n\t\t\t$scope.checkFunc = checkFunc;\n\t\t\t$scope.lock = false;\n\t\t\t$scope.create = create;\n\n\t\t\t$scope.config = typeof name === \"object\" ? name : {};\n\n\t\t\t// Init\n\t\t\tif(!entity) {\n\t\t\t\t$.each(fieldList, function (i, field) {\n\t\t\t\t\tif(field.defaultValue) {\n\t\t\t\t\t\t_entity[field.field] = field.defaultValue;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Modal\n\t\t\t$mdl = $(TMPL_FIELDS).appendTo('body');\n\t\t\t$compile($mdl)($scope);\n\t\t\t$mdl.modal();\n\t\t\tsetTimeout(function () {\n\t\t\t\t$mdl.find(\"input, select\").filter(':visible:first:enabled').focus();\n\t\t\t}, 500);\n\n\t\t\t$mdl.on(\"hide.bs.modal\", function() {\n\t\t\t\t_deferred.reject();\n\t\t\t});\n\t\t\t$mdl.on(\"hidden.bs.modal\", function() {\n\t\t\t\t_deferred.resolve({\n\t\t\t\t\tentity: _entity\n\t\t\t\t});\n\t\t\t\t$mdl.remove();\n\n\t\t\t\tif ($(\".modal-backdrop\").length) {\n\t\t\t\t\t$(\"body\").addClass(\"modal-open\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Function\n\t\t\t$scope.getFieldDescription = function (field) {\n\t\t\t\tif(typeof field.description === \"function\") {\n\t\t\t\t\treturn field.description($scope.entity);\n\t\t\t\t}\n\t\t\t\treturn field.description || ((field.name || field.field) + '...');\n\t\t\t};\n\n\t\t\t$scope.emptyFieldList = function() {\n\t\t\t\treturn $.map(fieldList, function(field) {\n\t\t\t\t\tif(!field.optional && !_entity[field.field]) {\n\t\t\t\t\t\treturn field.field;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.newField = function () {\n\t\t\t\tUI.fieldConfirm({\n\t\t\t\t\ttitle: \"New Field\"\n\t\t\t\t}, null, [{\n\t\t\t\t\tfield: \"field\",\n\t\t\t\t\tname: \"Field Name\"\n\t\t\t\t}])(function (entity, closeFunc, unlock) {\n\t\t\t\t\tif(common.array.find(entity.field, $scope.fieldList, \"field\")) {\n\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\t\tcontent: \"Field already exist!\"\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tunlock();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.fieldList.push({\n\t\t\t\t\t\t\tfield: entity.field,\n\t\t\t\t\t\t\t_customize: true\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcloseFunc();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.removeField = function (field) {\n\t\t\t\t$scope.fieldList = common.array.remove(field, $scope.fieldList);\n\t\t\t};\n\n\t\t\t$scope.confirm = function() {\n\t\t\t\t$scope.lock = true;\n\t\t\t\t_deferred.notify({\n\t\t\t\t\tentity: _entity,\n\t\t\t\t\tcloseFunc: function() {\n\t\t\t\t\t\t$mdl.modal('hide');\n\t\t\t\t\t},\n\t\t\t\t\tunlock: function() {\n\t\t\t\t\t\t$scope.lock = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t_bindShortcut($mdl);\n\n\t\t\treturn _deferred.promise;\n\t\t}\n\n\t\t/***\n\t\t * Create a customize field confirm modal.\n\t\t * @param {string} name\t\t\t\t\t\t\t- Create entity name\n\t\t * @param {object} entity\t\t\t\t\t\t- Bind entity\n\t\t * @param {Object[]} fieldList\t\t\t\t\t- Display fields\n\t\t * @param {string} fieldList[].field\t\t\t\t- Mapping entity field\n\t\t * @param {string=} fieldList[].name\t\t\t\t- Field display name\n\t\t * @param {*=} fieldList[].defaultValue\t\t\t\t- Field default value. Only will be set if entity object is undefined\n\t\t * @param {string=} fieldList[].type\t\t\t\t- Field types: 'select', 'blob'\n\t\t * @param {number=} fieldList[].rows\t\t\t\t- Display as textarea if rows is set\n\t\t * @param {string=} fieldList[].description\t\t\t- Display as placeholder\n\t\t * @param {boolean=} fieldList[].optional\t\t\t- Optional field will not block the confirm\n\t\t * @param {boolean=} fieldList[].readonly\t\t\t- Read Only can not be updated\n\t\t * @param {string[]=} fieldList[].valueList\t\t\t- For select type usage\n\t\t * @param {checkFieldFunction=} checkFunc\t- Check logic function. Return string will prevent access\n\t\t */\n\t\tUI.createConfirm = function(name, entity, fieldList, checkFunc) {\n\t\t\treturn wrapPromise(_fieldDialog(true, name, entity, fieldList, checkFunc));\n\t\t};\n\n\t\t/***\n\t\t * Create a customize field confirm modal.\n\t\t * @param {object} config\t\t\t\t\t\t- Configuration object\n\t\t * @param {string} config.title\t\t\t\t\t\t- Title of dialog box\n\t\t * @param {string=} config.size\t\t\t\t\t\t- \"large\". Set dialog size\n\t\t * @param {boolean=} config.addable\t\t\t\t\t- Set add customize field\n\t\t * @param {boolean=} config.confirm\t\t\t\t\t- Display or not confirm button\n\t\t * @param {string=} config.confirmDesc\t\t\t\t- Confirm button display description\n\t\t * @param {object} entity\t\t\t\t\t\t- bind entity\n\t\t * @param {Object[]} fieldList\t\t\t\t\t- Display fields\n\t\t * @param {string} fieldList[].field\t\t\t\t- Mapping entity field\n\t\t * @param {string=} fieldList[].name\t\t\t\t- Field display name\n\t\t * @param {*=} fieldList[].defaultValue\t\t\t\t- Field default value. Only will be set if entity object is undefined\n\t\t * @param {string=} fieldList[].type\t\t\t\t- Field types: 'select', 'blob'\n\t\t * @param {number=} fieldList[].rows\t\t\t\t- Display as textarea if rows is set\n\t\t * @param {string=} fieldList[].description\t\t\t- Display as placeholder\n\t\t * @param {boolean=} fieldList[].optional\t\t\t- Optional field will not block the confirm\n\t\t * @param {boolean=} fieldList[].readonly\t\t\t- Read Only can not be updated\n\t\t * @param {string[]=} fieldList[].valueList\t\t\t- For select type usage\n\t\t * @param {checkFieldFunction=} checkFunc\t- Check logic function. Return string will prevent access\n\t\t */\n\t\tUI.fieldConfirm = function(config, entity, fieldList, checkFunc) {\n\t\t\treturn wrapPromise(_fieldDialog(\"field\", config, entity, fieldList, checkFunc));\n\t\t};\n\n\t\tUI.deleteConfirm = function (name) {\n\t\t\tvar _deferred, $mdl, $scope;\n\n\t\t\t_deferred = $q.defer();\n\t\t\t$scope = $rootScope.$new(true);\n\t\t\t$scope.name = name;\n\t\t\t$scope.lock = false;\n\n\t\t\t// Modal\n\t\t\t$mdl = $(TMPL_DELETE).appendTo('body');\n\t\t\t$compile($mdl)($scope);\n\t\t\t$mdl.modal();\n\n\t\t\t$mdl.on(\"hide.bs.modal\", function() {\n\t\t\t\t_deferred.reject();\n\t\t\t});\n\t\t\t$mdl.on(\"hidden.bs.modal\", function() {\n\t\t\t\t_deferred.resolve({\n\t\t\t\t\tname: name\n\t\t\t\t});\n\t\t\t\t$mdl.remove();\n\n\t\t\t\tif ($(\".modal-backdrop\").length) {\n\t\t\t\t\t$(\"body\").addClass(\"modal-open\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Function\n\t\t\t$scope.delete = function() {\n\t\t\t\t$scope.lock = true;\n\t\t\t\t_deferred.notify({\n\t\t\t\t\tname: name,\n\t\t\t\t\tcloseFunc: function() {\n\t\t\t\t\t\t$mdl.modal('hide');\n\t\t\t\t\t},\n\t\t\t\t\tunlock: function() {\n\t\t\t\t\t\t$scope.lock = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\treturn wrapPromise(_deferred.promise);\n\t\t};\n\n\t\treturn UI;\n\t});\n\n\t// ===========================================================\n\t// =                         Template                        =\n\t// ===========================================================\n\tvar TMPL_FIELDS =\n\t\t'<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">' +\n\t\t'<div class=\"modal-dialog\" ng-class=\"{\\'modal-lg\\': config.size === \\'large\\'}\" role=\"document\">' +\n\t\t'<div class=\"modal-content\">' +\n\t\t'<div class=\"modal-header\">' +\n\t\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">' +\n\t\t\t\t'<span aria-hidden=\"true\">&times;</span>' +\n\t\t\t'</button>' +\n\t\t\t'<h4 class=\"modal-title\">{{config.title || (create ? \"New\" : \"Update\") + \" \" + name}}</h4>' +\n\t\t'</div>' +\n\t\t'<div class=\"modal-body\">' +\n\t\t\t'<div class=\"form-group\" ng-repeat=\"field in fieldList\" ng-switch=\"field.type\">' +\n\t\t\t\t'<label for=\"featureName\">' +\n\t\t\t\t\t'<span ng-if=\"!field.optional && !field._customize\">*</span> ' +\n\t\t\t\t\t'<a ng-if=\"field._customize\" class=\"fa fa-times\" ng-click=\"removeField(field)\"></a> ' +\n\t\t\t\t\t'{{field.name || field.field}}' +\n\t\t\t\t'</label>' +\n\t\t\t\t'<textarea class=\"form-control\" placeholder=\"{{getFieldDescription(field)}}\" ng-model=\"entity[field.field]\" rows=\"{{ field.rows || 10 }}\" ng-readonly=\"field.readonly\" ng-disabled=\"lock\" ng-switch-when=\"blob\"></textarea>' +\n\t\t\t\t'<select class=\"form-control\" ng-model=\"entity[field.field]\" ng-init=\"entity[field.field] = entity[field.field] || field.valueList[0]\" ng-switch-when=\"select\">' +\n\t\t\t\t'<option ng-repeat=\"value in field.valueList\">{{value}}</option>' +\n\t\t\t\t'</select>' +\n\t\t\t\t'<input type=\"text\" class=\"form-control\" placeholder=\"{{getFieldDescription(field)}}\" ng-model=\"entity[field.field]\" ng-readonly=\"field.readonly\" ng-disabled=\"lock\" ng-switch-default>' +\n\t\t\t'</div>' +\n\t\t\t'<a ng-if=\"config.addable\" ng-click=\"newField()\">+ New field</a>' +\n\t\t'</div>' +\n\t\t'<div class=\"modal-footer\">' +\n\t\t\t'<p class=\"pull-left text-danger\">{{checkFunc(entity)}}</p>' +\n\t\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\" ng-disabled=\"lock\">Close</button>' +\n\t\t\t'<button type=\"button\" class=\"btn btn-primary confirmBtn\" ng-click=\"confirm()\" ng-disabled=\"checkFunc(entity) || emptyFieldList().length || lock\" ng-if=\"config.confirm !== false\">' +\n\t\t\t\t'{{config.confirmDesc || (create ? \"Create\" : \"Update\")}}' +\n\t\t\t'</button>' +\n\t\t'</div>' +\n\t\t'</div>' +\n\t\t'</div>' +\n\t\t'</div>';\n\n\tvar TMPL_DELETE =\n\t\t'<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">' +\n\t\t'<div class=\"modal-dialog\">' +\n\t\t'<div class=\"modal-content\">' +\n\t\t'<div class=\"modal-header\">' +\n\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>' +\n\t\t'<h4 class=\"modal-title\">Delete Confirm</h4></div>' +\n\t\t'<div class=\"modal-body\">' +\n\t\t'<span class=\"text-red fa fa-exclamation-triangle pull-left\" style=\"font-size: 50px;\"></span>' +\n\t\t'<p>You are <strong class=\"text-red\">DELETING</strong> \\'{{name}}\\'!</p>' +\n\t\t'<p>Proceed to delete?</p>' +\n\t\t'</div>' +\n\t\t'<div class=\"modal-footer\">' +\n\t\t'<button type=\"button\" class=\"btn btn-danger\" ng-click=\"delete()\" ng-disabled=\"lock\">Delete</button>' +\n\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\" ng-disabled=\"lock\">Cancel</button>' +\n\t\t'</div>' +\n\t\t'</div>' +\n\t\t'</div>' +\n\t\t'</div>';\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar serviceModule = angular.module('eagle.service');\n\n\tserviceModule.service('Policy', function($q, UI, Entity) {\n\t\treturn {\n\t\t\tpublisherTypes: {\n\t\t\t\t'org.apache.eagle.alert.engine.publisher.impl.AlertEmailPublisher': {\n\t\t\t\t\tname: \"Email\",\n\t\t\t\t\tdisplayFields: [\"recipients\"],\n\t\t\t\t\tfields: [\"subject\", \"template\", \"sender\", \"recipients\"]\n\t\t\t\t},\n\t\t\t\t'org.apache.eagle.alert.engine.publisher.impl.AlertKafkaPublisher': {\n\t\t\t\t\tname: \"Kafka\",\n\t\t\t\t\tdisplayFields: [\"topic\"],\n\t\t\t\t\tfields: [\"topic\", \"kafka_broker\"]\n\t\t\t\t},\n\t\t\t\t'org.apache.eagle.alert.engine.publisher.impl.AlertSlackPublisher': {\n\t\t\t\t\tname: \"Slack\",\n\t\t\t\t\tdisplayFields: [\"channels\"],\n\t\t\t\t\tfields: [\"token\", \"channels\", \"severitys\", \"urltemplate\"]\n\t\t\t\t},\n\t\t\t\t'org.apache.eagle.alert.engine.publisher.impl.AlertEagleStorePlugin': {\n\t\t\t\t\tname: \"Storage\",\n\t\t\t\t\tdisplayFields: [],\n\t\t\t\t\tfields: []\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdelete: function (policy) {\n\t\t\t\tvar deferred = $q.defer();\n\n\t\t\t\tUI.deleteConfirm(policy.name)(function (entity, closeFunc) {\n\t\t\t\t\tEntity.deleteMetadata(\"policies/\" + policy.name)._promise.finally(function () {\n\t\t\t\t\t\tcloseFunc();\n\t\t\t\t\t\tdeferred.resolve();\n\t\t\t\t\t});\n\t\t\t\t}, function () {\n\t\t\t\t\tdeferred.reject();\n\t\t\t\t});\n\n\t\t\t\treturn deferred.promise;\n\t\t\t},\n\n\t\t\tstart: function (policy) {\n\t\t\t\treturn Entity.post(\"metadata/policies/\" + encodeURIComponent(policy.name) + \"/status/ENABLED\", {})._promise;\n\t\t\t},\n\n\t\t\tstop: function (policy) {\n\t\t\t\treturn Entity.post(\"metadata/policies/\" + encodeURIComponent(policy.name) + \"/status/DISABLED\", {})._promise;\n\t\t\t}\n\t\t};\n\t});\n})();\n\n/*\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n\r\n(function() {\r\n\t'use strict';\r\n\r\n\tangular.module('eagle.components', []);\r\n})();\r\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.directive('sortTable', function($compile) {\n\t\treturn {\n\t\t\trestrict: 'AE',\n\t\t\tscope: true,\n\t\t\t//terminal: true,\n\t\t\tpriority: 1001,\n\n\t\t\t/**\n\t\t\t * @param $scope\n\t\t\t * @param $element\n\t\t\t * @param {{}} $attrs\n\t\t\t * @param {string} $attrs.sortTable\t\t\tData source\n\t\t\t * @param {string?} $attrs.isSorting\t\tWill bind parent variable of sort state\n\t\t\t * @param {string?} $attrs.scope\t\t\tWill bind parent variable of current scope\n\t\t\t * @param {string?} $attrs.sortpath\t\t\tDefault sort path\n\t\t\t * @param {[]?} $attrs.searchPathList\t\tFilter search path list\n\t\t\t */\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t\tvar sortmatch;\n\t\t\t\tvar worker;\n\t\t\t\tvar worker_id = 0;\n\t\t\t\tif(typeof(Worker) !== \"undefined\") {\n\t\t\t\t\tworker = new Worker(\"public/js/worker/sortTableWorker.js?_=\" + window._TRS());\n\t\t\t\t}\n\n\t\t\t\t// Initialization\n\t\t\t\t$scope.pageNumber = 1;\n\t\t\t\t$scope.pageSize = 10;\n\t\t\t\t$scope.maxSize = 10;\n\t\t\t\t$scope.search = \"\";\n\t\t\t\t$scope.orderKey = \"\";\n\t\t\t\t$scope.orderAsc = true;\n\n\t\t\t\tif($attrs.sortpath) {\n\t\t\t\t\tsortmatch = $attrs.sortpath.match(/^(-)?(.*)$/);\n\t\t\t\t\tif(sortmatch[1]) {\n\t\t\t\t\t\t$scope.orderAsc = false;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.orderKey = sortmatch[2];\n\t\t\t\t}\n\n\t\t\t\t// UI - Column sort\n\t\t\t\t$scope.doSort = function(path) {\n\t\t\t\t\tif($scope.orderKey === path) {\n\t\t\t\t\t\t$scope.orderAsc = !$scope.orderAsc;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.orderKey = path;\n\t\t\t\t\t\t$scope.orderAsc = true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t$scope.checkSortClass = function(key) {\n\t\t\t\t\tif($scope.orderKey === key) {\n\t\t\t\t\t\treturn \"fa sort-mark \" + ($scope.orderAsc ? \"fa-sort-asc\" : \"fa-sort-desc\");\n\t\t\t\t\t}\n\t\t\t\t\treturn \"fa fa-sort sort-mark\";\n\t\t\t\t};\n\n\t\t\t\t// List filter & sort\n\t\t\t\tfunction setState(bool) {\n\t\t\t\t\tif(!$attrs.isSorting) return;\n\n\t\t\t\t\t$scope.$parent[$attrs.isSorting] = bool;\n\t\t\t\t}\n\n\n\t\t\t\tvar cacheSearch = \"\";\n\t\t\t\tvar cacheOrder = \"\";\n\t\t\t\tvar cacheOrderAsc = null;\n\t\t\t\tvar cacheFilteredList = null;\n\t\t\t\t$scope.getFilteredList = function () {\n\t\t\t\t\tif(\n\t\t\t\t\t\tcacheSearch !== $scope.search ||\n\t\t\t\t\t\tcacheOrder !== $scope.orderKey ||\n\t\t\t\t\t\tcacheOrderAsc !== $scope.orderAsc ||\n\t\t\t\t\t\t!cacheFilteredList\n\t\t\t\t\t) {\n\t\t\t\t\t\tcacheSearch = $scope.search;\n\t\t\t\t\t\tcacheOrder = $scope.orderKey;\n\t\t\t\t\t\tcacheOrderAsc = $scope.orderAsc;\n\n\t\t\t\t\t\tvar fullList = $scope.$parent[$attrs.sortTable] || [];\n\t\t\t\t\t\tif(!cacheFilteredList) cacheFilteredList = fullList;\n\n\t\t\t\t\t\tif(!worker) {\n\t\t\t\t\t\t\tcacheFilteredList = __sortTable_generateFilteredList(fullList, cacheSearch, cacheOrder, cacheOrderAsc, $scope.$parent[$attrs.searchPathList]);\n\t\t\t\t\t\t\tsetState(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tworker_id += 1;\n\t\t\t\t\t\t\tsetState(true);\n\t\t\t\t\t\t\tvar list = JSON.stringify(fullList);\n\t\t\t\t\t\t\tworker.postMessage({\n\t\t\t\t\t\t\t\tsearch: cacheSearch,\n\t\t\t\t\t\t\t\torder: cacheOrder,\n\t\t\t\t\t\t\t\torderAsc: cacheOrderAsc,\n\t\t\t\t\t\t\t\tsearchPathList: $scope.$parent[$attrs.searchPathList],\n\t\t\t\t\t\t\t\tlist: list,\n\t\t\t\t\t\t\t\tid: worker_id\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn cacheFilteredList;\n\t\t\t\t};\n\n\t\t\t\t// Week watch. Will not track each element\n\t\t\t\t$scope.$watch($attrs.sortTable + \".length\", function () {\n\t\t\t\t\tcacheFilteredList = null;\n\t\t\t\t});\n\t\t\t\t$scope.$watch($attrs.sortTable + \".___SORT_TABLE___\", function () {\n\t\t\t\t\tvar fullList = $scope.$parent[$attrs.sortTable];\n\t\t\t\t\tif(fullList && !fullList.___SORT_TABLE___) {\n\t\t\t\t\t\tfullList.___SORT_TABLE___ = +new Date();\n\t\t\t\t\t\tcacheFilteredList = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction workMessage(event) {\n\t\t\t\t\tvar data = event.data;\n\t\t\t\t\tif(worker_id !== data.id) return;\n\n\t\t\t\t\tsetState(false);\n\t\t\t\t\tcacheFilteredList = data.list;\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t}\n\t\t\t\tworker.addEventListener(\"message\", workMessage);\n\n\t\t\t\t$scope.$on('$destroy', function() {\n\t\t\t\t\tworker.removeEventListener(\"message\", workMessage);\n\t\t\t\t});\n\n\t\t\t\t// Scope bind\n\t\t\t\tif($attrs.scope) {\n\t\t\t\t\t$scope.$parent[$attrs.scope] = $scope;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcompile: function ($element) {\n\t\t\t\tvar contents = $element.contents().remove();\n\n\t\t\t\treturn {\n\t\t\t\t\tpost: function preLink($scope, $element) {\n\t\t\t\t\t\t$scope.defaultPageSizeList = [10, 25, 50, 100];\n\n\t\t\t\t\t\t$element.append(contents);\n\n\t\t\t\t\t\t// Tool Container\n\t\t\t\t\t\tvar $toolContainer = $(\n\t\t\t\t\t\t\t'<div class=\"tool-container clearfix\">' +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t).insertBefore($element.find(\"table\"));\n\n\t\t\t\t\t\t// Search Box\n\t\t\t\t\t\tvar $search = $(\n\t\t\t\t\t\t\t'<div class=\"search-box\">' +\n\t\t\t\t\t\t\t'<input type=\"search\" class=\"form-control input-sm\" placeholder=\"Search\" ng-model=\"search\" />' +\n\t\t\t\t\t\t\t'<span class=\"fa fa-search\" />' +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t).appendTo($toolContainer);\n\t\t\t\t\t\t$compile($search)($scope);\n\n\t\t\t\t\t\t// Page Size\n\t\t\t\t\t\tvar $pageSize = $(\n\t\t\t\t\t\t\t'<div class=\"page-size\">' +\n\t\t\t\t\t\t\t'Show' +\n\t\t\t\t\t\t\t'<select class=\"form-control\" ng-model=\"pageSize\" convert-to-number>' +\n\t\t\t\t\t\t\t'<option ng-repeat=\"size in pageSizeList || defaultPageSizeList track by $index\">{{size}}</option>' +\n\t\t\t\t\t\t\t'</select>' +\n\t\t\t\t\t\t\t'Entities' +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t).appendTo($toolContainer);\n\t\t\t\t\t\t$compile($pageSize)($scope);\n\n\t\t\t\t\t\t// Sort Column\n\t\t\t\t\t\t$element.find(\"table [sortpath]\").each(function () {\n\t\t\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\t\t\tvar _sortpath = $this.attr(\"sortpath\");\n\t\t\t\t\t\t\t$this.attr(\"ng-click\", \"doSort('\" + _sortpath + \"')\");\n\t\t\t\t\t\t\t$this.prepend('<span ng-class=\"checkSortClass(\\'' + _sortpath + '\\')\"></span>');\n\t\t\t\t\t\t\t$compile($this)($scope);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Repeat Items\n\t\t\t\t\t\tvar $tr = $element.find(\"table [ts-repeat], table > tbody > tr\").filter(\":first\");\n\t\t\t\t\t\t$tr.attr(\"ng-repeat\", 'item in getFilteredList().slice((pageNumber - 1) * pageSize, pageNumber * pageSize) track by $index');\n\t\t\t\t\t\t$compile($tr)($scope);\n\n\t\t\t\t\t\t// Page Navigation\n\t\t\t\t\t\tvar $navigation = $(\n\t\t\t\t\t\t\t'<div class=\"navigation-bar clearfix\">' +\n\t\t\t\t\t\t\t'<span>' +\n\t\t\t\t\t\t\t'show {{(pageNumber - 1) * pageSize + 1}} to {{pageNumber * pageSize}} of {{getFilteredList().length}} items' +\n\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t'<uib-pagination total-items=\"getFilteredList().length\" ng-model=\"pageNumber\" boundary-links=\"true\" items-per-page=\"pageSize\" max-size=\"maxSize\"></uib-pagination>' +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t).appendTo($element);\n\t\t\t\t\t\t$compile($navigation)($scope);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t});\n\n\teagleComponents.directive('convertToNumber', function() {\n\t\treturn {\n\t\t\trequire: 'ngModel',\n\t\t\tlink: function(scope, element, attrs, ngModel) {\n\t\t\t\tngModel.$parsers.push(function(val) {\n\t\t\t\t\treturn parseInt(val, 10);\n\t\t\t\t});\n\t\t\t\tngModel.$formatters.push(function(val) {\n\t\t\t\t\treturn '' + val;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.service('Chart', function () {\n\t\treturn {\n\t\t\tcolor: [ \"#0073b7\", \"#dd4b39\", \"#00a65a\", \"#f39c12\", \"#605ca8\", \"#001F3F\", \"#39CCCC\", \"#D81B60\", \"#3c8dbc\", \"#f56954\", \"#00c0ef\", \"#3D9970\", \"#FF851B\"  , \"#01FF70\", \"#F012BE\"],\n\t\t\t//color: ['#4285f4', '#c23531','#2f4554', '#61a0a8', '#d48265', '#91c7ae','#749f83',  '#ca8622', '#bda29a','#6e7074', '#546570', '#c4ccd3'],\n\t\t\tcharts: {}\n\t\t};\n\t});\n\n\teagleComponents.directive('chart', function(Chart) {\n\t\tvar charts = Chart.charts;\n\n\t\tfunction chartResize() {\n\t\t\tsetTimeout(function () {\n\t\t\t\t$.each(charts, function (id, chart) {\n\t\t\t\t\tchart.resize();\n\t\t\t\t});\n\t\t\t}, 310);\n\t\t}\n\n\t\t$(window).resize(chartResize);\n\t\t$(\"body\").on(\"expanded.pushMenu collapsed.pushMenu\", chartResize);\n\n\t\treturn {\n\t\t\trestrict: 'AE',\n\t\t\tscope: {\n\t\t\t\ttitle: \"@?title\",\n\t\t\t\tseries: \"=\",\n\t\t\t\tcategory: \"=?category\",\n\t\t\t\tcategoryFunc: \"=?categoryFunc\",\n\t\t\t\txTitle: \"@?xTitle\",\n\t\t\t\tyTitle: \"@?yTitle\",\n\n\t\t\t\toption: \"=?option\",\n\n\t\t\t\tclick: \"=?ngClick\",\n\n\t\t\t\tchart: \"@?chart\"\n\t\t\t},\n\t\t\tcontroller: function ($scope, $element, $attrs, Time) {\n\t\t\t\tvar i;\n\t\t\t\tvar lastTooltipEvent;\n\t\t\t\tvar chart = echarts.init($element[0]);\n\t\t\t\tcharts[chart.id] = chart;\n\n\t\t\t\tfunction refreshChart() {\n\t\t\t\t\tvar maxYAxis = 0;\n\t\t\t\t\tvar legendList = [];\n\t\t\t\t\tvar categoryList = $scope.category ? $scope.category : [];\n\n\t\t\t\t\tvar seriesList = $.map($scope.series || [], function (series, id) {\n\t\t\t\t\t\tif(id === 0 && !$scope.category) {\n\t\t\t\t\t\t\t//var preDate = -1;\n\t\t\t\t\t\t\tcategoryList = $.map(series.data, function (point) {\n\t\t\t\t\t\t\t\t/*ivar time = new Time(point.x);\n\t\t\t\t\t\t\t\tf(preDate !== time.date()) {\n\t\t\t\t\t\t\t\t\tpreDate = time.date();\n\t\t\t\t\t\t\t\t\treturn Time.format(point.x, \"MMM.D HH:mm\");\n\t\t\t\t\t\t\t\t}*/\n\t\t\t\t\t\t\t\tif($scope.categoryFunc) {\n\t\t\t\t\t\t\t\t\treturn $scope.categoryFunc(point.x);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn Time.format(point.x, \"HH:mm\");\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlegendList.push(series.name);\n\t\t\t\t\t\tif(series.yAxisIndex) maxYAxis = Math.max(series.yAxisIndex, maxYAxis);\n\n\t\t\t\t\t\treturn $.extend({}, series, {\n\t\t\t\t\t\t\tdata: $scope.category ? series.data : $.map(series.data, function (point) {\n\t\t\t\t\t\t\t\treturn point.y;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tvar yAxis = [];\n\t\t\t\t\tfor(i = 0 ; i <= maxYAxis ; i += 1) {\n\t\t\t\t\t\tyAxis.push({\n\t\t\t\t\t\t\tname: $scope.yTitle,\n\t\t\t\t\t\t\ttype: \"value\"\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar option = {\n\t\t\t\t\t\tcolor: Chart.color.concat(),\n\t\t\t\t\t\ttitle: [{text: $scope.title}],\n\t\t\t\t\t\ttooltip: {trigger: 'axis'},\n\t\t\t\t\t\tlegend: [{\n\t\t\t\t\t\t\tdata: legendList\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tgrid: {\n\t\t\t\t\t\t\ttop: '30',\n\t\t\t\t\t\t\tleft: '0',\n\t\t\t\t\t\t\tright: '0',\n\t\t\t\t\t\t\tbottom: '0',\n\t\t\t\t\t\t\tcontainLabel: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\txAxis: {\n\t\t\t\t\t\t\tname: $scope.xTitle,\n\t\t\t\t\t\t\ttype: 'category',\n\t\t\t\t\t\t\tdata: categoryList,\n\t\t\t\t\t\t\taxisTick: { show: false }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tyAxis: yAxis,\n\t\t\t\t\t\tseries: seriesList\n\t\t\t\t\t};\n\n\t\t\t\t\tif($scope.option) {\n\t\t\t\t\t\toption = common.merge(option, $scope.option);\n\t\t\t\t\t}\n\n\t\t\t\t\tchart.setOption(option);\n\t\t\t\t}\n\n\t\t\t\t// Event handle\n\t\t\t\tvar chartClick = false;\n\t\t\t\tchart.on(\"click\", function (e) {\n\t\t\t\t\tif($scope.click) {\n\t\t\t\t\t\tif($scope.click(e)) {\n\t\t\t\t\t\t\trefreshChart();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tchartClick = true;\n\t\t\t\t});\n\n\t\t\t\tchart.getZr().on('click', function () {\n\t\t\t\t\tif(!chartClick && $scope.click) {\n\t\t\t\t\t\tif($scope.click($.extend({\n\t\t\t\t\t\t\tcomponentType: \"tooltip\"\n\t\t\t\t\t\t}, lastTooltipEvent))) {\n\t\t\t\t\t\t\trefreshChart();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tchartClick = false;\n\t\t\t\t});\n\n\t\t\t\tchart.on('showtip', function (e) {\n\t\t\t\t\tlastTooltipEvent = e;\n\t\t\t\t});\n\n\t\t\t\t// Insert chart object to parent scope\n\t\t\t\tif($attrs.chart) {\n\t\t\t\t\t$scope.$parent.$parent[$attrs.chart] = chart;\n\t\t\t\t}\n\n\t\t\t\tchart.refresh = function () {\n\t\t\t\t\trefreshChart();\n\t\t\t\t};\n\n\t\t\t\t// Render\n\t\t\t\trefreshChart();\n\t\t\t\t$scope.$watch(\"series\", refreshChart);\n\n\t\t\t\t$scope.$on('$destroy', function() {\n\t\t\t\t\tdelete charts[chart.id];\n\t\t\t\t\tchart.dispose();\n\n\t\t\t\t\tdelete $scope.$parent.$parent[$attrs.chart];\n\t\t\t\t});\n\t\t\t},\n\t\t\ttemplate: '<div>Loading...</div>',\n\t\t\treplace: true\n\t\t};\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.directive('widget', function($compile, Site) {\n\t\treturn {\n\t\t\trestrict: 'AE',\n\t\t\tpriority: 1001,\n\n\t\t\tcontroller: function($scope, $element, $attrs) {\n\t\t\t},\n\t\t\tcompile: function ($element) {\n\t\t\t\t$element.contents().remove();\n\n\t\t\t\treturn {\n\t\t\t\t\tpost: function preLink($scope, $element) {\n\t\t\t\t\t\tvar widget = $scope.widget;\n\t\t\t\t\t\t$scope.site = Site.current();\n\n\t\t\t\t\t\tif(widget.renderFunc) {\n\t\t\t\t\t\t\t// Prevent auto compile if return false\n\t\t\t\t\t\t\tif(widget.renderFunc($element, $scope, $compile) !== false) {\n\t\t\t\t\t\t\t\t$compile($element.contents())($scope);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$element.append(\"Widget don't provide render function:\" + widget.application + \" - \" + widget.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.directive('staticInclude', function($http, $templateCache, $compile) {\n\t\treturn function(scope, element, attrs) {\n\t\t\tvar templatePath = attrs.staticInclude;\n\t\t\t$http.get(templatePath, { cache: $templateCache }).success(function(response) {\n\t\t\t\tvar contents = element.html(response).contents();\n\t\t\t\t$compile(contents)(scope);\n\t\t\t});\n\t\t};\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.directive('editor', function() {\n\t\treturn {\n\t\t\trestrict: 'AE',\n\t\t\trequire: 'ngModel',\n\n\t\t\tlink: function($scope, $element, $attrs, $ctrl) {\n\t\t\t\t$element.innerHeight(21 * Number($attrs.rows || 10));\n\n\t\t\t\tvar updateId;\n\t\t\t\tfunction updateScope(value) {\n\t\t\t\t\tclearTimeout(updateId);\n\n\t\t\t\t\tupdateId = setTimeout(function () {\n\t\t\t\t\t\t$ctrl.$setViewValue(value);\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\n\t\t\t\tvar editLock = false;\n\n\t\t\t\tvar editor = ace.edit($element[0]);\n\t\t\t\tvar session = editor.getSession();\n\t\t\t\teditor.container.style.lineHeight = 1.5;\n\t\t\t\teditor.setOptions({\n\t\t\t\t\tfontSize: \"14px\"\n\t\t\t\t});\n\t\t\t\teditor.setTheme(\"ace/theme/tomorrow\");\n\t\t\t\teditor.$blockScrolling = Infinity;\n\t\t\t\teditor.getSession().on('change', function(event) {\n\t\t\t\t\teditLock = true;\n\n\t\t\t\t\tvar value = session.getValue();\n\t\t\t\t\tupdateScope(value);\n\n\t\t\t\t});\n\t\t\t\tsession.setUseWorker(false);\n\t\t\t\tsession.setUseWrapMode(true);\n\t\t\t\tsession.setMode(\"ace/mode/sql\");\n\n\t\t\t\t$scope.$watch($attrs.ngModel, function (newValue) {\n\t\t\t\t\tif(editLock) {\n\t\t\t\t\t\teditLock = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tsession.setValue(newValue || \"\");\n\t\t\t\t});\n\n\t\t\t\t$scope.$on('$destroy', function() {\n\t\t\t\t\teditor.destroy();\n\t\t\t\t});\n\t\t\t},\n\t\t\ttemplate: '<div class=\"form-control\"></div>',\n\t\t\treplace: true\n\t\t};\n\t});\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleComponents = angular.module('eagle.components');\n\n\teagleComponents.directive('naBlock', function() {\n\t\treturn {\n\t\t\tscope: {\n\t\t\t\tnaBlock: \"=\"\n\t\t\t},\n\t\t\trestrict: 'AE',\n\t\t\ttransclude: true,\n\n\t\t\ttemplate:\n\t\t\t'<div>' +\n\t\t\t\t'<span ng-if=\"naBlock && naBlock !== true\">{{naBlock}}</span>' +\n\t\t\t\t'<code ng-if=\"!naBlock\">N/A</code>' +\n\t\t\t\t'<div ng-if=\"naBlock === true\" ng-transclude></div>' +\n\t\t\t'</div>',\n\t\t\treplace: true\n\t\t};\n\t});\n})();\n\n/*\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n(function() {\r\n\t'use strict';\r\n\r\n\tvar eagleControllers = angular.module('eagleControllers', ['ui.bootstrap', 'eagle.components', 'eagle.service']);\r\n\r\n\t// ===========================================================\r\n\t// =                        Controller                       =\r\n\t// ===========================================================\r\n})();\r\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleControllers = angular.module('eagleControllers');\n\n\t// ======================================================================================\n\t// =                                        Home                                        =\n\t// ======================================================================================\n\teagleControllers.controller('homeCtrl', function ($scope, $wrapState, PageConfig) {\n\t\tPageConfig.title = \"Home\";\n\n\t\t$scope.colorList = [\n\t\t\t\"bg-aqua\",\n\t\t\t\"bg-green\",\n\t\t\t\"bg-yellow\",\n\t\t\t\"bg-red\"\n\t\t];\n\t});\n\n\t// ======================================================================================\n\t// =                                       Set Up                                       =\n\t// ======================================================================================\n\teagleControllers.controller('setupCtrl', function ($wrapState, $scope, PageConfig, Entity, Site) {\n\t\tPageConfig.hideTitle = true;\n\n\t\t$scope.lock = false;\n\t\t$scope.siteId = \"sandbox\";\n\t\t$scope.siteName = \"Sandbox\";\n\t\t$scope.description = \"\";\n\n\t\t$scope.createSite = function () {\n\t\t\t$scope.lock = true;\n\n\t\t\tEntity.create(\"sites\", {\n\t\t\t\tsiteId: $scope.siteId,\n\t\t\t\tsiteName: $scope.siteName,\n\t\t\t\tdescription: $scope.description\n\t\t\t})._then(function () {\n\t\t\t\tSite.reload();\n\t\t\t\t$wrapState.go('home');\n\t\t\t}, function (res) {\n\t\t\t\t$.dialog({\n\t\t\t\t\ttitle: \"OPS!\",\n\t\t\t\t\tcontent: res.message\n\t\t\t\t});\n\t\t\t}).finally(function () {\n\t\t\t\t$scope.lock = false;\n\t\t\t});\n\t\t};\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleControllers = angular.module('eagleControllers');\n\n\t// ======================================================================================\n\t// =                                        Alert                                       =\n\t// ======================================================================================\n\teagleControllers.controller('alertListCtrl', function ($scope, $wrapState, $interval, PageConfig, Entity) {\n\t\tPageConfig.title = \"Alerts\";\n\n\t\t$scope.displayType = \"raw\";\n\t\t$scope.alertList = Entity.queryMetadata(\"alerts\", {size: 10000});\n\n\t\t// ================================================================\n\t\t// =                             Sync                             =\n\t\t// ================================================================\n\t\tvar refreshInterval = $interval($scope.alertList._refresh, 1000 * 10);\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$interval.cancel(refreshInterval);\n\t\t});\n\t});\n\n\teagleControllers.controller('alertDetailCtrl', function ($scope, $wrapState, PageConfig, Entity) {\n\t\tPageConfig.title = \"Alert Detail\";\n\n\t\t$scope.alertList = Entity.queryMetadata(\"alerts/\" + encodeURIComponent($wrapState.param.alertId));\n\t\t$scope.alertList._then(function () {\n\t\t\t$scope.alert = $scope.alertList[0];\n\t\t\tif(!$scope.alert) {\n\t\t\t\t$.dialog({\n\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\tcontent: \"Alert '\" + $wrapState.param.alertId + \"' not found!\"\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\t// ======================================================================================\n\t// =                                       Stream                                       =\n\t// ======================================================================================\n\teagleControllers.controller('alertStreamListCtrl', function ($scope, $wrapState, PageConfig, Application, Entity) {\n\t\tPageConfig.title = \"Streams\";\n\n\t\t$scope.streamList = [];\n\t\tEntity.queryMetadata(\"streams\")._then(function (res) {\n\t\t\t$scope.streamList = $.map(res.data, function (stream) {\n\t\t\t\tvar application = Application.findProvider(stream.dataSource);\n\t\t\t\treturn $.extend({application: application}, stream);\n\t\t\t});\n\t\t});\n\n\t\t$scope.dataSources = {};\n\t\tEntity.queryMetadata(\"datasources\")._then(function(res) {\n\t\t\t$.each(res.data, function (i, dataSource) {\n\t\t\t\t$scope.dataSources[dataSource.name] = dataSource;\n\t\t\t});\n\t\t});\n\n\t\t$scope.showDataSource = function (stream) {\n\t\t\tvar dataSource = $scope.dataSources[stream.dataSource];\n\t\t\t$.dialog({\n\t\t\t\ttitle: dataSource.name,\n\t\t\t\tcontent: $(\"<pre class='text-break'>\").html(JSON.stringify(dataSource, null, \"\\t\")),\n\t\t\t\tsize: \"large\"\n\t\t\t});\n\t\t};\n\t});\n\n\t// ======================================================================================\n\t// =                                       Policy                                       =\n\t// ======================================================================================\n\teagleControllers.controller('policyListCtrl', function ($scope, $wrapState, PageConfig, Entity, Policy) {\n\t\tPageConfig.title = \"Policies\";\n\n\t\t$scope.policyList = [];\n\n\t\tfunction updateList() {\n\t\t\tvar list = Entity.queryMetadata(\"policies\");\n\t\t\tlist._then(function () {\n\t\t\t\t$scope.policyList = list;\n\t\t\t});\n\t\t}\n\t\tupdateList();\n\n\t\t$scope.deletePolicy = function(policy) {\n\t\t\tPolicy.delete(policy).then(updateList);\n\t\t};\n\n\t\t$scope.startPolicy = function(policy) {\n\t\t\tPolicy.start(policy).then(updateList);\n\t\t};\n\n\t\t$scope.stopPolicy = function(policy) {\n\t\t\tPolicy.stop(policy).then(updateList);\n\t\t};\n\t});\n\n\teagleControllers.controller('policyDetailCtrl', function ($scope, $wrapState, $interval, PageConfig, Entity, Policy) {\n\t\tPageConfig.title = \"Policy\";\n\t\tPageConfig.subTitle = \"Detail\";\n\t\tPageConfig.navPath = [\n\t\t\t{title: \"Policy List\", path: \"/policies\"},\n\t\t\t{title: \"Detail\"}\n\t\t];\n\n\t\t$scope.tab = \"setting\";\n\t\t$scope.displayType = \"raw\";\n\n\t\t$scope.setTab = function (tab) {\n\t\t\t$scope.tab = tab;\n\t\t};\n\n\t\tfunction updatePolicy() {\n\t\t\tvar policyName = $wrapState.param.name;\n\t\t\tvar encodePolicyName = encodeURIComponent(policyName);\n\t\t\tvar policyList = Entity.queryMetadata(\"policies/\" + encodePolicyName);\n\t\t\tpolicyList._promise.then(function () {\n\t\t\t\t$scope.policy = policyList[0];\n\t\t\t\tconsole.log(\"[Policy]\", $scope.policy);\n\n\t\t\t\tif(!$scope.policy) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: \"Policy '\" + $wrapState.param.name + \"' not found!\"\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\t$wrapState.go(\"policyList\");\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tEntity.post(\"metadata/policies/parse\", $scope.policy.definition.value)._then(function (res) {\n\t\t\t\t\t$scope.executionPlan = res.data;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$scope.policyPublisherList = Entity.queryMetadata(\"policies/\" + encodePolicyName + \"/publishments/\");\n\n\t\t\tEntity.queryMetadata(\"schedulestates\")._then(function (res) {\n\t\t\t\tvar schedule = res.data || {};\n\t\t\t\t$scope.assignment = common.array.find(policyName, schedule.assignments, [\"policyName\"]) || {};\n\n\t\t\t\tvar queueList = $.map(schedule.monitoredStreams, function (stream) {\n\t\t\t\t\treturn stream.queues;\n\t\t\t\t});\n\t\t\t\t$scope.queue = common.array.find($scope.assignment.queueId, queueList, [\"queueId\"]);\n\t\t\t});\n\t\t}\n\t\tupdatePolicy();\n\n\t\t$scope.alertList = Entity.queryMetadata(\"policies/\" + encodeURIComponent($wrapState.param.name) + \"/alerts\", {size: 1000});\n\n\t\t$scope.deletePolicy = function() {\n\t\t\tPolicy.delete($scope.policy).then(function () {\n\t\t\t\t$wrapState.go(\"policyList\");\n\t\t\t});\n\t\t};\n\n\t\t$scope.startPolicy = function() {\n\t\t\tPolicy.start($scope.policy).then(updatePolicy);\n\t\t};\n\n\t\t$scope.stopPolicy = function() {\n\t\t\tPolicy.stop($scope.policy).then(updatePolicy);\n\t\t};\n\n\t\tvar refreshInterval = $interval($scope.alertList._refresh, 1000 * 60);\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$interval.cancel(refreshInterval);\n\t\t});\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleControllers = angular.module('eagleControllers');\n\n\t// ======================================================================================\n\t// =                                    Policy Create                                   =\n\t// ======================================================================================\n\tfunction connectPolicyEditController(entity, args) {\n\t\tvar newArgs = [entity];\n\t\tArray.prototype.push.apply(newArgs, args);\n\t\t/* jshint validthis: true */\n\t\tpolicyEditController.apply(this, newArgs);\n\t}\n\n\teagleControllers.controller('policyCreateCtrl', function ($scope, $q, $wrapState, $timeout, PageConfig, Entity, Policy) {\n\t\tPageConfig.title = \"Define Policy\";\n\t\tconnectPolicyEditController({}, arguments);\n\t});\n\teagleControllers.controller('policyEditCtrl', function ($scope, $q, $wrapState, $timeout, PageConfig, Entity, Policy) {\n\t\tPageConfig.title = \"Edit Policy\";\n\t\tvar args = arguments;\n\n\t\t$scope.policyList = Entity.queryMetadata(\"policies/\" + encodeURIComponent($wrapState.param.name));\n\t\t$scope.policyList._promise.then(function () {\n\t\t\tvar policy = $scope.policyList[0];\n\n\t\t\tif(policy) {\n\t\t\t\tconnectPolicyEditController(policy, args);\n\t\t\t} else {\n\t\t\t\t$.dialog({\n\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\tcontent: \"Policy '\" + $wrapState.param.name + \"' not found!\"\n\t\t\t\t}, function () {\n\t\t\t\t\t$wrapState.go(\"policyList\");\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\tfunction policyEditController(policy, $scope, $q, $wrapState, $timeout, PageConfig, Entity, Policy) {\n\t\t$scope.publisherTypes = Policy.publisherTypes;\n\n\t\t$scope.policy = policy;\n\t\t$scope.policy = common.merge({\n\t\t\tname: \"\",\n\t\t\tdescription: \"\",\n\t\t\tinputStreams: [],\n\t\t\toutputStreams: [],\n\t\t\tdefinition: {\n\t\t\t\ttype: \"siddhi\",\n\t\t\t\tvalue: \"\"\n\t\t\t},\n\t\t\talertDefinition: {\n\t\t\t\tsubject: \"\",\n\t\t\t\tbody: \"\",\n\t\t\t\tseverity: \"WARNING\",\n\t\t\t\tcategory: \"DEFAULT\"\n\t\t\t},\n\t\t\tpartitionSpec: [],\n\t\t\tparallelismHint: 5\n\t\t}, $scope.policy);\n\t\tconsole.log(\"[Policy]\", $scope.policy);\n\n\t\tvar cacheSearchType;\n\t\tvar cacheSearchSourceKey;\n\t\tvar searchApplications;\n\n\t\t$scope.searchType = \"app\";\n\t\t$scope.searchSourceKey = \"\";\n\t\t$scope.applications = {};\n\t\t$scope.newPolicy = !$scope.policy.name;\n\t\t$scope.autoPolicyDescription = $scope.newPolicy && !$scope.policy.description;\n\n\t\tPageConfig.navPath = [\n\t\t\t{title: \"Policy List\", path: \"/policies\"},\n\t\t\t{title: ($scope.newPolicy ? \"Define\" : \"Update\") + \" Policy\"}\n\t\t];\n\n\t\t// ==============================================================\n\t\t// =                             UI                             =\n\t\t// ==============================================================\n\t\t$scope.sourceTab = \"all\";\n\t\t$scope.setSourceTab = function (tab) {\n\t\t\t$scope.sourceTab = tab;\n\t\t};\n\n\t\t// ==============================================================\n\t\t// =                        Input Stream                        =\n\t\t// ==============================================================\n\t\t$scope.getSearchApplication = function() {\n\t\t\tif(cacheSearchSourceKey !== $scope.searchSourceKey.toUpperCase() || cacheSearchType !== $scope.searchType) {\n\t\t\t\tvar match = false;\n\t\t\t\tcacheSearchSourceKey = $scope.searchSourceKey.toUpperCase();\n\t\t\t\tcacheSearchType = $scope.searchType;\n\n\t\t\t\tsearchApplications = {};\n\t\t\t\t$.each($scope.applications, function (appName, streams) {\n\t\t\t\t\t$.each(streams, function (i, stream) {\n\t\t\t\t\t\tvar groupName = cacheSearchType === \"app\" ? stream.dataSource : stream.siteId;\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\tgroupName.toUpperCase().indexOf(cacheSearchSourceKey) >= 0 ||\n\t\t\t\t\t\t\tstream.streamId.toUpperCase().indexOf(cacheSearchSourceKey) >= 0\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t\t\tvar group = searchApplications[groupName] = searchApplications[groupName] || [];\n\t\t\t\t\t\t\tgroup.push(stream);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tif(!match) {\n\t\t\t\t\tsearchApplications = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn searchApplications;\n\t\t};\n\n\t\t$scope.streams = {};\n\t\t$scope.streamList = Entity.queryMetadata(\"streams\");\n\t\t$scope.streamList._then(function () {\n\t\t\t$scope.applications = {};\n\t\t\tcacheSearchSourceKey = null;\n\n\t\t\t$.each($scope.streamList, function (i, stream) {\n\t\t\t\tvar list = $scope.applications[stream.dataSource] = $scope.applications[stream.dataSource] || [];\n\t\t\t\tlist.push(stream);\n\t\t\t\t$scope.streams[stream.streamId] = stream;\n\t\t\t});\n\t\t});\n\n\t\t$scope.isInputStreamSelected = function (streamId) {\n\t\t\treturn $.inArray(streamId, $scope.policy.inputStreams) >= 0;\n\t\t};\n\n\t\t/*$scope.checkInputStream = function (streamId) {\n\t\t\tif($scope.isInputStreamSelected(streamId)) {\n\t\t\t\t$scope.policy.inputStreams = common.array.remove(streamId, $scope.policy.inputStreams);\n\t\t\t} else {\n\t\t\t\t$scope.policy.inputStreams.push(streamId);\n\t\t\t}\n\t\t};*/\n\n\t\t// ==============================================================\n\t\t// =                         Definition                         =\n\t\t// ==============================================================\n\t\tfunction autoDescription() {\n\t\t\tif(!$scope.autoPolicyDescription) return;\n\n\t\t\t$scope.policy.description = \"Policy for \" + $scope.policy.outputStreams.join(\", \");\n\t\t}\n\n\t\tvar checkPromise;\n\t\t$scope.definitionMessage = \"\";\n\t\t$scope.checkDefinition = function () {\n\t\t\t$timeout.cancel(checkPromise);\n\t\t\tcheckPromise = $timeout(function () {\n\t\t\t\tEntity.post(\"metadata/policies/parse\", $scope.policy.definition.value)._then(function (res) {\n\t\t\t\t\tvar data = res.data;\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tif(data.success) {\n\t\t\t\t\t\t$scope.definitionMessage = \"\";\n\t\t\t\t\t\tif(data.policyExecutionPlan) {\n\t\t\t\t\t\t\t// Input streams\n\t\t\t\t\t\t\t$scope.policy.inputStreams = $.map(data.policyExecutionPlan.inputStreams, function (value, stream) {\n\t\t\t\t\t\t\t\treturn stream;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Output streams\n\t\t\t\t\t\t\tvar outputStreams= $.map(data.policyExecutionPlan.outputStreams, function (value, stream) {\n\t\t\t\t\t\t\t\treturn stream;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$scope.policy.outputStreams = outputStreams.concat();\n\t\t\t\t\t\t\t$scope.outputStreams = outputStreams;\n\t\t\t\t\t\t\tautoDescription();\n\n\t\t\t\t\t\t\t// Partition\n\t\t\t\t\t\t\t$scope.policy.partitionSpec = data.policyExecutionPlan.streamPartitions;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.definitionMessage = data.message;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, 350);\n\t\t};\n\n\t\t// ==============================================================\n\t\t// =                        Output Stream                       =\n\t\t// ==============================================================\n\t\t$scope.outputStreams = ($scope.policy.outputStreams || []).concat();\n\n\t\t$scope.isOutputStreamSelected = function (streamId) {\n\t\t\treturn $.inArray(streamId, $scope.policy.outputStreams) >= 0;\n\t\t};\n\n\t\t$scope.checkOutputStream = function (streamId) {\n\t\t\tif($scope.isOutputStreamSelected(streamId)) {\n\t\t\t\t$scope.policy.outputStreams = common.array.remove(streamId, $scope.policy.outputStreams);\n\t\t\t} else {\n\t\t\t\t$scope.policy.outputStreams.push(streamId);\n\t\t\t}\n\t\t\tautoDescription();\n\t\t};\n\n\t\t// ==============================================================\n\t\t// =                         Partition                          =\n\t\t// ==============================================================\n\t\t$scope.partition = {};\n\n\t\t$scope.addPartition = function () {\n\t\t\t$scope.partition = {\n\t\t\t\tstreamId: $scope.policy.inputStreams[0],\n\t\t\t\ttype: \"GROUPBY\",\n\t\t\t\tcolumns: []\n\t\t\t};\n\t\t\t$(\".modal[data-id='partitionMDL']\").modal();\n\t\t};\n\n\t\t$scope.newPartitionCheckColumn = function (column) {\n\t\t\treturn $.inArray(column, $scope.partition.columns) >= 0;\n\t\t};\n\n\t\t$scope.newPartitionClickColumn = function (column) {\n\t\t\tif($scope.newPartitionCheckColumn(column)) {\n\t\t\t\t$scope.partition.columns = common.array.remove(column, $scope.partition.columns);\n\t\t\t} else {\n\t\t\t\t$scope.partition.columns.push(column);\n\t\t\t}\n\t\t};\n\n\t\t$scope.addPartitionConfirm = function () {\n\t\t\t$scope.policy.partitionSpec.push($scope.partition);\n\t\t};\n\n\t\t$scope.removePartition = function (partition) {\n\t\t\t$scope.policy.partitionSpec = common.array.remove(partition, $scope.policy.partitionSpec);\n\t\t};\n\n\t\t// ==============================================================\n\t\t// =                         Publisher                          =\n\t\t// ==============================================================\n\t\t$scope.publisherList = Entity.queryMetadata(\"publishments\");\n\t\t$scope.addPublisherType = \"\";\n\t\t$scope.policyPublisherList = [];\n\t\t$scope.publisher = {};\n\n\t\tif(!$scope.newPolicy) {\n\t\t\tEntity.queryMetadata(\"policies/\" + $scope.policy.name + \"/publishments/\")._then(function (res) {\n\t\t\t\t$scope.policyPublisherList = $.map(res.data, function (publisher) {\n\t\t\t\t\treturn $.extend({\n\t\t\t\t\t\t_exist: true\n\t\t\t\t\t}, publisher);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t$scope.addPublisher = function () {\n\t\t\t$scope.publisher = {\n\t\t\t\texistPublisher: $scope.publisherList[0],\n\t\t\t\ttype: \"org.apache.eagle.alert.engine.publisher.impl.AlertEmailPublisher\",\n\t\t\t\tdedupIntervalMin: \"PT1M\",\n\t\t\t\tserializer : \"org.apache.eagle.alert.engine.publisher.impl.StringEventSerializer\",\n\t\t\t\tproperties: {}\n\t\t\t};\n\t\t\tif($scope.publisherList.length) {\n\t\t\t\t$scope.addPublisherType = \"exist\";\n\t\t\t} else {\n\t\t\t\t$scope.addPublisherType = \"new\";\n\t\t\t}\n\n\t\t\t$(\".modal[data-id='publisherMDL']\").modal();\n\t\t};\n\n\t\t$scope.removePublisher = function (publisher) {\n\t\t\t$scope.policyPublisherList = common.array.remove(publisher, $scope.policyPublisherList);\n\t\t};\n\n\t\t$scope.checkPublisherName = function () {\n\t\t\tif(common.array.find($scope.publisher.name, $scope.publisherList.concat($scope.policyPublisherList), [\"name\"])) {\n\t\t\t\treturn \"'\" + $scope.publisher.name + \"' already exist\";\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t$scope.addPublisherConfirm = function () {\n\t\t\tif($scope.addPublisherType === \"exist\") {\n\t\t\t\t$scope.publisher = $.extend({\n\t\t\t\t\t_exist: true\n\t\t\t\t}, $scope.publisher.existPublisher);\n\t\t\t}\n\t\t\tvar properties = {};\n\t\t\t$.each(Policy.publisherTypes[$scope.publisher.type].fields, function (i, field) {\n\t\t\t\tproperties[field] = $scope.publisher.properties[field] || \"\";\n\t\t\t});\n\t\t\t$scope.policyPublisherList.push($.extend({}, $scope.publisher, {properties: properties}));\n\t\t};\n\n\t\t// ==============================================================\n\t\t// =                            Save                            =\n\t\t// ==============================================================\n\t\t$scope.saveLock = false;\n\t\t$scope.saveCheck = function () {\n\t\t\treturn (\n\t\t\t\t!$scope.saveLock &&\n\t\t\t\t$scope.policy.name &&\n\t\t\t\tcommon.number.parse($scope.policy.parallelismHint) > 0 &&\n\t\t\t\t$scope.policy.definition.value &&\n\t\t\t\t$scope.policy.outputStreams.length &&\n\t\t\t\t$scope.policyPublisherList.length\n\t\t\t);\n\t\t};\n\n\t\t$scope.saveConfirm = function () {\n\t\t\t$scope.saveLock = true;\n\n\t\t\t// Check policy\n\t\t\tEntity.post(\"metadata/policies/validate\", $scope.policy)._then(function (res) {\n\t\t\t\tvar validate = res.data;\n\t\t\t\tconsole.log(validate);\n\t\t\t\tif(!validate.success) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: validate.message\n\t\t\t\t\t});\n\t\t\t\t\t$scope.saveLock = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Create publisher\n\t\t\t\tvar publisherPromiseList = $.map($scope.policyPublisherList, function (publisher) {\n\t\t\t\t\tif(publisher._exist) return;\n\n\t\t\t\t\treturn Entity.create(\"metadata/publishments\", publisher)._promise;\n\t\t\t\t});\n\t\t\t\tif(publisherPromiseList.length) console.log(\"Creating publishers...\", $scope.policyPublisherList);\n\n\t\t\t\t$q.all(publisherPromiseList).then(function () {\n\t\t\t\t\tconsole.log(\"Create publishers success...\");\n\n\t\t\t\t\t// Create policy\n\t\t\t\t\tEntity.create(\"metadata/policies\", $scope.policy)._then(function () {\n\t\t\t\t\t\tconsole.log(\"Create policy success...\");\n\t\t\t\t\t\t// Link with publisher\n\t\t\t\t\t\tEntity.post(\"metadata/policies/\" + $scope.policy.name + \"/publishments/\", $.map($scope.policyPublisherList, function (publisher) {\n\t\t\t\t\t\t\treturn publisher.name;\n\t\t\t\t\t\t}))._then(function () {\n\t\t\t\t\t\t\t// Link Success\n\t\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\t\ttitle: \"Done\",\n\t\t\t\t\t\t\t\tcontent: \"Close dialog to go to the policy detail page.\"\n\t\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\t\t$wrapState.go(\"policyDetail\", {name: $scope.policy.name});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, function (res) {\n\t\t\t\t\t\t\t// Link Failed\n\t\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\t\t\tcontent: \"Link publishers failed:\" + res.data.message\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).finally(function () {\n\t\t\t\t\t\t\t$scope.policyLock = false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}, function (res) {\n\t\t\t\t\t\t$.dialog({\n\t\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\t\tcontent: \"Create policy failed: \" + res.data.message\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$scope.policyLock = false;\n\t\t\t\t\t});\n\t\t\t\t}, function (args) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: \"Create publisher failed. More detail please check output in 'console'.\"\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log(\"Create publishers failed:\", args);\n\t\t\t\t\t$scope.policyLock = false;\n\t\t\t\t});\n\t\t\t}, function () {\n\t\t\t\t$scope.saveLock = false;\n\t\t\t});\n\t\t};\n\t}\n})();\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleControllers = angular.module('eagleControllers');\n\n\t// ======================================================================================\n\t// =                                        Main                                        =\n\t// ======================================================================================\n\teagleControllers.controller('integrationCtrl', function ($scope, $wrapState, PageConfig) {\n\t\tPageConfig.title = \"Integration\";\n\t\t$scope.getState = function() {\n\t\t\treturn $wrapState.current.name;\n\t\t};\n\t});\n\n\t// ======================================================================================\n\t// =                                        Site                                        =\n\t// ======================================================================================\n\teagleControllers.controller('integrationSiteListCtrl', function ($scope, $wrapState, PageConfig, UI, Entity, Site) {\n\t\tPageConfig.title = \"Integration\";\n\t\tPageConfig.subTitle = \"Site\";\n\n\t\t$scope.deleteSite = function (site) {\n\t\t\tUI.deleteConfirm(site.siteId)\n\t\t\t(function (entity, closeFunc, unlock) {\n\t\t\t\tEntity.delete(\"sites\", site.uuid)._then(function (res) {\n\t\t\t\t\tSite.reload();\n\t\t\t\t\tcloseFunc();\n\t\t\t\t}, function (res) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: common.getValueByPath(res, [\"data\", \"message\"])\n\t\t\t\t\t});\n\t\t\t\t\tunlock();\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\t$scope.newSite = function () {\n\t\t\tUI.createConfirm(\"Site\", {}, [\n\t\t\t\t{field: \"siteId\", name: \"Site Id\"},\n\t\t\t\t{field: \"siteName\", name: \"Display Name\", optional: true},\n\t\t\t\t{field: \"description\", name: \"Description\", optional: true, type: \"blob\", rows: 5}\n\t\t\t])(function (entity, closeFunc, unlock) {\n\t\t\t\tEntity.create(\"sites\", entity)._then(function () {\n\t\t\t\t\tSite.reload();\n\t\t\t\t\tcloseFunc();\n\t\t\t\t}, unlock);\n\t\t\t});\n\t\t};\n\t});\n\n\teagleControllers.controller('integrationSiteCtrl', function ($sce, $scope, $wrapState, $interval, PageConfig, Entity, UI, Site, Application) {\n\t\tPageConfig.title = \"Site\";\n\t\tPageConfig.subTitle = $wrapState.param.id;\n\n\t\t// Check site\n\t\t$scope.site = Site.find($wrapState.param.id);\n\t\tif(!$scope.site) {\n\t\t\t$.dialog({\n\t\t\t\ttitle: \"OPS\",\n\t\t\t\tcontent: \"Site not found!\"\n\t\t\t}, function () {\n\t\t\t\t$wrapState.go(\"integration.siteList\");\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(\"[Site]\", $scope.site);\n\n\t\t$scope.siteName = $scope.site.siteId + ($scope.site.siteName ? \"(\" + $scope.site.siteName + \")\" : \"\");\n\n\t\t// Map applications\n\t\tfunction mapApplications() {\n\t\t\tSite.getPromise().then(function () {\n\t\t\t\t$scope.site = Site.find($wrapState.param.id);\n\t\t\t\tvar uninstalledApplicationList = common.array.minus(Application.providerList, $scope.site.applicationList, \"type\", \"descriptor.type\");\n\t\t\t\t$scope.applicationList = common.array.doSort(\n\t\t\t\t\t$.map($scope.site.applicationList, function (app) {\n\t\t\t\t\t\tapp.installed = true;\n\t\t\t\t\t\treturn app;\n\t\t\t\t\t}), [\"origin\", \"name\"]\n\t\t\t\t).concat(\n\t\t\t\t\tcommon.array.doSort(\n\t\t\t\t\t\t$.map(uninstalledApplicationList, function (oriApp) {\n\t\t\t\t\t\t\treturn {origin: oriApp};\n\t\t\t\t\t\t}), [\"origin\", \"name\"]\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t\tmapApplications();\n\n\t\t// Application refresh\n\t\tvar refreshApplications = $scope.refreshApplications = function() {\n\t\t\tApplication.reload().getPromise().then(mapApplications);\n\t\t};\n\n\t\t// Application status class\n\t\t$scope.getAppStatusClass = function (application) {\n\t\t\tswitch((application.status || \"\").toUpperCase()) {\n\t\t\t\tcase \"INITIALIZED\":\n\t\t\t\t\treturn \"primary\";\n\t\t\t\tcase \"STARTING\":\n\t\t\t\t\treturn \"warning\";\n\t\t\t\tcase \"RUNNING\":\n\t\t\t\t\treturn \"success\";\n\t\t\t\tcase \"STOPPING\":\n\t\t\t\t\treturn \"warning\";\n\t\t\t\tcase \"STOPPED\":\n\t\t\t\t\treturn \"danger\";\n\t\t\t}\n\t\t\treturn \"default\";\n\t\t};\n\n\t\t// Get started application count\n\t\t$scope.getStartedAppCount = function () {\n\t\t\treturn $.grep($scope.site.applicationList, function (app) {\n\t\t\t\treturn $.inArray((app.status || \"\").toUpperCase(), [\"STARTING\", \"RUNNING\"]) >= 0;\n\t\t\t}).length;\n\t\t};\n\n\t\t// Application detail\n\t\t$scope.showAppDetail = function (application) {\n\t\t\t$(\"a[data-id='introTab']\").click();\n\n\t\t\t$scope.tmpApp = application;\n\t\t\tapplication = application.origin;\n\t\t\tvar docs = application.docs || {install: \"\", uninstall: \"\"};\n\t\t\t$scope.application = application;\n\t\t\t$scope.installHTML = $sce.trustAsHtml(docs.install);\n\t\t\t$scope.uninstallHTML = $sce.trustAsHtml(docs.uninstall);\n\t\t\t$(\"#appMDL\").modal();\n\t\t};\n\n\t\t// ================================================================\n\t\t// =                         Installation                         =\n\t\t// ================================================================\n\t\t$scope.tmpApp = {};\n\t\t$scope.generalFields = [];\n\t\t$scope.advancedFields = [];\n\t\t$scope.customizeFields = [];\n\t\t$scope.installLock = false;\n\n\t\t// =================== Fields ===================\n\t\t$scope.newField = function () {\n\t\t\tUI.fieldConfirm({\n\t\t\t\ttitle: \"New Property\"\n\t\t\t}, null, [{\n\t\t\t\tfield: \"name\",\n\t\t\t\tname: \"Property Name\"\n\t\t\t}, {\n\t\t\t\tfield: \"value\",\n\t\t\t\tname: \"Property Value\",\n\t\t\t\toptional: true\n\t\t\t}])(function (entity, closeFunc, unlock) {\n\t\t\t\tvar fullList = $scope.generalFields.concat($scope.advancedFields).concat($scope.customizeFields);\n\t\t\t\tif(common.array.find(entity.name, fullList, \"field\")) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: \"Property already exist!\"\n\t\t\t\t\t});\n\n\t\t\t\t\tunlock();\n\t\t\t\t} else {\n\t\t\t\t\t$scope.customizeFields.push({\n\t\t\t\t\t\tname: entity.name,\n\t\t\t\t\t\t_customize: true,\n\t\t\t\t\t\trequired: true\n\t\t\t\t\t});\n\t\t\t\t\t$scope.tmpApp.configuration[entity.name] = entity.value;\n\n\t\t\t\t\tcloseFunc();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.removeField = function (field) {\n\t\t\t$scope.customizeFields = common.array.remove(field, $scope.customizeFields);\n\t\t\tdelete $scope.tmpApp.configuration[field.name];\n\t\t};\n\n\t\t// =================== Check ===================\n\t\t$scope.checkJarPath = function () {\n\t\t\tvar jarPath = ($scope.tmpApp || {}).jarPath;\n\t\t\tif(/\\.jar$/.test(jarPath)) {\n\t\t\t\t$scope.tmpApp.mode = \"CLUSTER\";\n\t\t\t} else if(/\\.class/.test(jarPath)) {\n\t\t\t\t$scope.tmpApp.mode = \"LOCAL\";\n\t\t\t}\n\t\t};\n\n\t\t$scope.collapseCheck = function () {\n\t\t\tsetTimeout(function() {\n\t\t\t\t$scope.$apply();\n\t\t\t}, 400);\n\t\t};\n\n\t\t$scope.isCollapsed = function (dataId) {\n\t\t\treturn !$(\"[data-id='\" + dataId + \"']\").hasClass(\"in\");\n\t\t};\n\n\t\t$scope.checkFields = function () {\n\t\t\tvar pass = true;\n\t\t\tvar config = common.getValueByPath($scope, [\"tmpApp\", \"configuration\"], {});\n\t\t\t$.each($scope.generalFields, function (i, field) {\n\t\t\t\tif (field.required && !config[field.name]) {\n\t\t\t\t\tpass = false;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn pass;\n\t\t};\n\n\t\t// =================== Config ===================\n\t\t$scope.getCustomFields = function (configuration) {\n\t\t\tvar fields = common.getValueByPath($scope.application, \"configuration.properties\", []).concat();\n\t\t\treturn $.map(configuration || {}, function (value, key) {\n\t\t\t\tif(!common.array.find(key, fields, [\"name\"])) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: key,\n\t\t\t\t\t\t_customize: true,\n\t\t\t\t\t\trequired: true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.configByJSON = function () {\n\t\t\tUI.fieldConfirm({\n\t\t\t\ttitle: \"Configuration\"\n\t\t\t}, {\n\t\t\t\tjson: JSON.stringify($scope.tmpApp.configuration, null, \"\\t\")\n\t\t\t}, [{\n\t\t\t\tfield: \"json\",\n\t\t\t\tname: \"JSON Configuration\",\n\t\t\t\ttype: \"blob\"\n\t\t\t}], function (entity) {\n\t\t\t\tvar json = common.parseJSON(entity.json, false);\n\t\t\t\tif(!json) return 'Require JSON format';\n\t\t\t})(function (entity, closeFunc) {\n\t\t\t\t$scope.tmpApp.configuration = common.parseJSON(entity.json, {});\n\t\t\t\t$scope.customizeFields = $scope.getCustomFields($scope.tmpApp.configuration);\n\t\t\t\tcloseFunc();\n\t\t\t});\n\t\t};\n\n\t\t// =================== Install ===================\n\t\t$scope.installAppConfirm = function () {\n\t\t\t$scope.installLock = true;\n\n\t\t\tvar uuid = $scope.tmpApp.uuid;\n\t\t\tvar app = $.extend({}, $scope.tmpApp);\n\t\t\tdelete app.uuid;\n\n\t\t\tif(uuid) {\n\t\t\t\tEntity.create(\"apps/\" + uuid, app)._then(function () {\n\t\t\t\t\trefreshApplications();\n\t\t\t\t\t$(\"#installMDL\").modal(\"hide\");\n\t\t\t\t}, function (res) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: res.data.message\n\t\t\t\t\t});\n\t\t\t\t\t$scope.installLock = false;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tEntity.create(\"apps/install\", app)._then(function () {\n\t\t\t\t\trefreshApplications();\n\t\t\t\t\t$(\"#installMDL\").modal(\"hide\");\n\t\t\t\t}, function (res) {\n\t\t\t\t\t$.dialog({\n\t\t\t\t\t\ttitle: \"OPS\",\n\t\t\t\t\t\tcontent: res.data.message\n\t\t\t\t\t});\n\t\t\t\t\t$scope.installLock = false;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t// Install application\n\t\t$scope.installApp = function (application, entity) {\n\t\t\tentity = entity || {};\n\t\t\tapplication = application.origin;\n\t\t\t$scope.installLock = false;\n\t\t\t$scope.application = application;\n\n\t\t\tvar docs = application.docs || {install: \"\", uninstall: \"\"};\n\t\t\t$scope.installHTML = $sce.trustAsHtml(docs.install);\n\n\t\t\t$scope.tmpApp = {\n\t\t\t\tmode: \"CLUSTER\",\n\t\t\t\tjarPath: application.jarPath,\n\t\t\t\tconfiguration: {}\n\t\t\t};\n\n\t\t\tif(!entity.uuid) {\n\t\t\t\tcommon.merge($scope.tmpApp, {\n\t\t\t\t\tsiteId: $scope.site.siteId,\n\t\t\t\t\tappType: application.type\n\t\t\t\t});\n\t\t\t\t$scope.checkJarPath();\n\t\t\t}\n\n\t\t\tvar fields = common.getValueByPath(application, \"configuration.properties\", []).concat();\n\t\t\t$scope.generalFields = [];\n\t\t\t$scope.advancedFields = [];\n\t\t\t$scope.customizeFields = [];\n\n\t\t\t$(\"[data-id='appEnvironment']\").attr(\"class\",\"collapse in\").removeAttr(\"style\");\n\t\t\t$(\"[data-id='appGeneral']\").attr(\"class\",\"collapse in\").removeAttr(\"style\");\n\t\t\t$(\"[data-id='appAdvanced']\").attr(\"class\",\"collapse\").removeAttr(\"style\");\n\t\t\t$(\"[data-id='appCustomize']\").attr(\"class\",\"collapse in\").removeAttr(\"style\");\n\n\t\t\t$.each(fields, function (i, field) {\n\t\t\t\t// Fill default value\n\t\t\t\t$scope.tmpApp.configuration[field.name] = common.template(field.value || \"\", {\n\t\t\t\t\tsiteId: $scope.site.siteId,\n\t\t\t\t\tappType: application.type\n\t\t\t\t});\n\n\t\t\t\t// Reassign the fields\n\t\t\t\tif(field.required) {\n\t\t\t\t\t$scope.generalFields.push(field);\n\t\t\t\t} else {\n\t\t\t\t\t$scope.advancedFields.push(field);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Fill miss field of entity\n\t\t\tcommon.merge($scope.tmpApp, entity);\n\t\t\t$scope.customizeFields = $scope.getCustomFields(entity.configuration);\n\n\t\t\t// Dependencies check\n\t\t\tvar missDep = false;\n\t\t\t$.each(application.dependencies, function (i, dep) {\n\t\t\t\tif(!Application.find(dep.type, $scope.site.siteId)[0]) {\n\t\t\t\t\tmissDep = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#installMDL\").modal();\n\t\t\tif(missDep) {\n\t\t\t\t$(\"a[data-id='guideTab']\").click();\n\t\t\t} else {\n\t\t\t\t$(\"a[data-id='configTab']\").click();\n\t\t\t}\n\t\t};\n\n\t\t// Uninstall application\n\t\t$scope.uninstallApp = function (application) {\n\t\t\tUI.deleteConfirm(application.descriptor.name + \" - \" + application.site.siteId)\n\t\t\t(function (entity, closeFunc, unlock) {\n\t\t\t\tEntity.delete(\"apps/uninstall\", application.uuid)._then(function () {\n\t\t\t\t\trefreshApplications();\n\t\t\t\t\tcloseFunc();\n\t\t\t\t}, unlock);\n\t\t\t});\n\t\t};\n\n\t\t// ================================================================\n\t\t// =                          Management                          =\n\t\t// ================================================================\n\t\t// Start application\n\t\t$scope.startApp = function (application) {\n\t\t\t$.dialog({\n\t\t\t\ttitle: \"Confirm\",\n\t\t\t\tcontent: \"Do you want to start '\" + application.descriptor.name + \"'?\",\n\t\t\t\tconfirm: true\n\t\t\t}, function (ret) {\n\t\t\t\tif(!ret) return;\n\t\t\t\tEntity.post(\"apps/start\", { uuid: application.uuid })._then(function () {\n\t\t\t\t\trefreshApplications();\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\t// Stop application\n\t\t$scope.stopApp = function (application) {\n\t\t\t$.dialog({\n\t\t\t\ttitle: \"Confirm\",\n\t\t\t\tcontent: \"Do you want to stop '\" + application.descriptor.name + \"'?\",\n\t\t\t\tconfirm: true\n\t\t\t}, function (ret) {\n\t\t\t\tif(!ret) return;\n\t\t\t\tEntity.post(\"apps/stop\", { uuid: application.uuid })._then(function () {\n\t\t\t\t\trefreshApplications();\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\t$scope.editApp = function (application) {\n\t\t\tvar type = application.descriptor.type;\n\t\t\tvar provider = Application.findProvider(type);\n\n\t\t\t$scope.installApp({origin: provider}, {\n\t\t\t\tmode: application.mode,\n\t\t\t\tjarPath: application.jarPath,\n\t\t\t\tuuid: application.uuid,\n\t\t\t\tconfiguration: $.extend({}, application.configuration)\n\t\t\t});\n\t\t};\n\n\t\t// ================================================================\n\t\t// =                             Sync                             =\n\t\t// ================================================================\n\t\tvar refreshInterval = $interval(refreshApplications, 1000 * 60);\n\t\t$scope.$on('$destroy', function() {\n\t\t\t$interval.cancel(refreshInterval);\n\t\t});\n\t});\n\n\t// ======================================================================================\n\t// =                                     Application                                    =\n\t// ======================================================================================\n\teagleControllers.controller('integrationApplicationListCtrl', function ($sce, $scope, $wrapState, PageConfig, Application) {\n\t\tPageConfig.title = \"Integration\";\n\t\tPageConfig.subTitle = \"Applications\";\n\n\t\t$scope.showAppDetail = function(application) {\n\t\t\tvar docs = application.docs || {install: \"\", uninstall: \"\"};\n\t\t\t$scope.application = application;\n\t\t\t$scope.installHTML = $sce.trustAsHtml(docs.install);\n\t\t\t$scope.uninstallHTML = $sce.trustAsHtml(docs.uninstall);\n\t\t\t$(\"#appMDL\").modal();\n\t\t};\n\t});\n}());\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\t'use strict';\n\n\tvar eagleControllers = angular.module('eagleControllers');\n\n\n\t// ======================================================================================\n\t// =                                        Main                                        =\n\t// ======================================================================================\n\teagleControllers.controller('siteCtrl', function ($scope, PageConfig, Site) {\n\t\tvar site = Site.current();\n\t\tPageConfig.title = site.siteName || site.siteId;\n\t\tPageConfig.subTitle = \"home\";\n\t});\n}());\n\n//# sourceMappingURL=doc.js.map"]}